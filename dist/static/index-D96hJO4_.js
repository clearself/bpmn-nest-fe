import{o as oe,$ as s,z as le,A as se,q as ne,B as re}from"./index-CJd2VQGz.js";import ie from"./formModel-CPGoXieT.js";import ue from"./formDataModel-CWG4OdOq.js";import{i as de,c as ce,g as U}from"./server-u4QY2yny.js";import{h as pe,a as me}from"./antDesign-wbdAq9hh.js";import{d as _e,f as b,r as $,o as fe,W as c,X as p,a0 as C,a1 as w,k as t,Z as l,u as a,G as x,a5 as m,a8 as f,Y as I,F as M,g as ve}from"./vue-CuEiQHfR.js";import"./echarts-DSOc99Qa.js";import"./server-BVWBzwKu.js";const ye=()=>({columns:[{lang:"columns.index",dataIndex:"index",width:50},{lang:"role.columns.roleName",dataIndex:"roleName",ellipsis:!0},{lang:"role.columns.roleKey",dataIndex:"roleKey",ellipsis:!0},{lang:"role.columns.state",dataIndex:"status",ellipsis:!0},{lang:"role.columns.createTime",dataIndex:"createTime",ellipsis:!0},{lang:"columns.operation",dataIndex:"operation"}]}),ge={class:"search-wrapper"},we={class:"ub ub-ac ub-pj top-opt w100"},xe={class:"mt-1 w100",id:"roleTable"},be={key:0},he={key:2},Se=_e({__name:"index",setup(P){const{proxy:V}=ve(),{sys_normal_disable:N}=V.useDict("sys_normal_disable"),{filterOption:A}=se(),{pagination:i,loading:v,scrollY:O}=oe(),{columns:E}=ye(),h=b(!1),z=b("add"),T=b(!1),K=b([]),D=b([]);let k=$({});const n=$({roleName:"",roleKey:"",status:void 0}),L=()=>{n.roleName="",n.roleKey="",n.status=void 0};fe(()=>{y()});const S=()=>{y()},Y=r=>new Promise(async e=>{const d=await ce({id:r.roleId});(d==null?void 0:d.code)===200&&(me.success(s("opeateSuccess")),y()),e(!0)}),j=()=>{z.value="add",h.value=!0},q=async r=>{const e=await U(r.roleId);(e==null?void 0:e.code)===200&&(k=e.data,e.data,z.value="edit",h.value=!0)},G=async r=>{const e=await U(r.roleId);(e==null?void 0:e.code)===200&&(k=e.data,e.data,T.value=!0)},y=async()=>{v.value=!0;const r={roleName:n.roleName,roleKey:n.roleKey,status:n.status,pageNum:i.current,pageSize:i.pageSize},e=await de(r);if((e==null?void 0:e.code)===200){v.value=!1;const{total:d=0,list:g=[]}=e.data;i.total=d,K.value=g}else v.value=!1},R=()=>{i.current=1,y()},W=()=>{i.current=1,L(),y()},X=r=>{i.current=r.current,i.pageSize=r.pageSize,y()};return(r,e)=>{const d=c("a-input"),g=c("a-form-item"),Z=c("a-select"),_=c("a-button"),H=c("a-form"),B=c("a-card"),J=ne,Q=re,ee=c("a-popconfirm"),ae=c("a-table");return p(),C(M,null,[w("div",ge,[t(B,{size:"small"},{default:l(()=>[t(H,{model:n,layout:"inline"},{default:l(()=>[t(g,{label:a(s)("role.columns.roleName")},{default:l(()=>[t(d,{allowClear:"",value:n.roleName,"onUpdate:value":e[0]||(e[0]=o=>n.roleName=o),valueModifiers:{trim:!0},placeholder:a(s)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),t(g,{label:a(s)("role.columns.roleKey")},{default:l(()=>[t(d,{allowClear:"",value:n.roleKey,"onUpdate:value":e[1]||(e[1]=o=>n.roleKey=o),valueModifiers:{trim:!0},placeholder:a(s)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),t(g,{label:a(s)("role.columns.state")},{default:l(()=>[t(Z,{"show-search":"","filter-option":a(A),options:a(N),allowClear:"",placeholder:a(s)("selectTips"),style:{width:"220px"},value:n.status,"onUpdate:value":e[2]||(e[2]=o=>n.status=o)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"]),t(g,null,{default:l(()=>[w("div",null,[t(_,{loading:a(v),type:"primary",onClick:R},{default:l(()=>[x(m(a(s)("opts.search")),1)]),_:1},8,["loading"]),t(_,{loading:a(v),class:"ml-1",onClick:W},{default:l(()=>[x(m(a(s)("opts.reset")),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1})]),w("div",we,[w("div",null,[t(_,{size:"small",type:"primary",onClick:j},{icon:l(()=>[t(a(pe))]),default:l(()=>[x(" "+m(a(s)("opts.add")),1)]),_:1})]),w("div",null,[t(_,{type:"link",ref:"ref2",shape:"circle"},{default:l(()=>[t(J,{tabKey:"role-table",value:D.value,"onUpdate:value":e[3]||(e[3]=o=>D.value=o),columns:a(E)},null,8,["value","columns"])]),_:1},512)])]),t(B,{size:"small"},{default:l(()=>[w("div",xe,[t(ae,{class:"ant-table-striped","row-class-name":(o,u)=>u%2===1?"table-striped":null,bordered:"",size:"small",columns:D.value,"row-key":o=>o.deptId,"data-source":K.value,pagination:a(i),loading:a(v),scroll:{y:a(O)},onChange:X},{bodyCell:l(({column:o,record:u,index:te})=>[o.dataIndex==="index"?(p(),C("a",be,m((a(i).current-1)*a(i).pageSize+parseInt(te)+1),1)):f("",!0),o.dataIndex==="status"?(p(),I(Q,{key:1,options:a(N),value:u.status},null,8,["options","value"])):f("",!0),o.dataIndex==="createTime"?(p(),C("span",he,m(a(le)(u.createTime)),1)):f("",!0),o.dataIndex==="operation"?(p(),C(M,{key:3},[u.roleId!==1?(p(),I(_,{key:0,type:"link",size:"small",onClick:F=>q(u)},{default:l(()=>[x(m(a(s)("opts.edit")),1)]),_:2},1032,["onClick"])):f("",!0),u.roleId!==1?(p(),I(_,{key:1,type:"link",size:"small",onClick:F=>G(u)},{default:l(()=>[x(m(a(s)("role.opts.dataPermiss")),1)]),_:2},1032,["onClick"])):f("",!0),t(ee,{title:a(s)("sureTips"),"ok-text":a(s)("opts.sure"),"cancel-text":a(s)("opts.cancel"),onConfirm:F=>Y(u)},{default:l(()=>[u.roleId!==1?(p(),I(_,{key:0,type:"link",size:"small",danger:""},{default:l(()=>[x(m(a(s)("opts.delete")),1)]),_:1})):f("",!0)]),_:2},1032,["title","ok-text","cancel-text","onConfirm"])],64)):f("",!0)]),_:1},8,["row-class-name","columns","row-key","data-source","pagination","loading","scroll"])])]),_:1}),t(ie,{show:h.value,"onUpdate:show":e[4]||(e[4]=o=>h.value=o),status:z.value,"cur-data":a(k),sysNormalDisable:a(N),onSuccess:S},null,8,["show","status","cur-data","sysNormalDisable"]),t(ue,{show:T.value,"onUpdate:show":e[5]||(e[5]=o=>T.value=o),"cur-data":a(k),onSuccess:S},null,8,["show","cur-data"])],64)}}});export{Se as default};
