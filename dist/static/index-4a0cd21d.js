import{j as Y,$ as h,l as k,w as Z}from"./index-bd69efc7.js";import{I as j,i as U,m as S}from"./antDesign-1cc9e1c8.js";import{d as q,f as d,W as w,X as z,a0 as B,k as o,Z as r,a1 as f,u as a,G as I,a6 as x,a9 as H,F as J}from"./vue-ced722ac.js";import"./echarts-de64fab6.js";const M=()=>({columns:[{lang:"columns.index",dataIndex:"index",fixed:"left",width:50},{lang:"example.columns.name",dataIndex:"name",ellipsis:!0},{lang:"example.columns.content",dataIndex:"content",ellipsis:!0}]}),P={class:"ub ub-ac ub-pj top-opt w100"},Q={class:"mt-1 w100"},ee={key:0},se=q({__name:"index",setup(D){const{pagination:s,scrollY:E,loading:g,selectedRows:C,rowSelection:V,clearTableSelected:F}=Y(),{columns:L}=M(),$=d("https://www.flypa.cn/dataTemplate.xlsx"),y=d([]),b=d(""),_=d(!1),T=d([]),i=d([]),O=async e=>{F(),i.value=e.list,b.value=e.fileName,_.value=!1,A()},A=()=>{g.value=!0,setTimeout(()=>{const e=(s.current-1)*s.pageSize,t=e+s.pageSize,l=i.value.slice(e,t),p={total:i.value.length,records:l};g.value=!1;const{total:u,records:c}=p;s.total=u,T.value=c},500)},G=e=>{s.current=e.current,s.pageSize=e.pageSize,A()},N=(e,t,l,p,u)=>{let c=[];if(!Array.isArray(e))return console.warn("数据请传入数组");if(!Array.isArray(l))return console.warn("标题请传入数组");if(!Array.isArray(u))return console.warn("字段请传入数组");c=e.map(W=>u.map(X=>W[X])),c.splice(0,0,l);const v=k.aoa_to_sheet(c),n=k.book_new(),m=[{hidden:!1}];v["!rows"]=m,k.book_append_sheet(n,v,p),Z(n,t+".xlsx")},K=()=>{if(i.value.length===0){S.warning("请先导入数据");return}if(C.value.length===0){S.warning("请至少选择一条数据");return}const e=["名称","内容"],t=["name","content"];N(C.value,b.value,e,"sheetName",t)},R=()=>{if(i.value.length===0){S.warning("请先导入数据");return}const e=["名称","内容"],t=["name","content"];N(i.value,b.value,e,"sheetName",t)};return(e,t)=>{const l=w("a-button"),p=w("fields-setting"),u=w("a-table"),c=w("a-card"),v=w("UploadImport");return z(),B(J,null,[o(c,{size:"small"},{default:r(()=>[f("div",P,[f("div",null,[o(l,{type:"primary",onClick:t[0]||(t[0]=n=>_.value=!0)},{icon:r(()=>[o(a(j))]),default:r(()=>[I(" "+x(a(h)("opts.import")),1)]),_:1}),o(l,{class:"ml-1",type:"primary",onClick:K},{icon:r(()=>[o(a(U))]),default:r(()=>[I(" "+x(a(h)("opts.exportSelected")),1)]),_:1}),o(l,{class:"ml-1",type:"primary",onClick:R},{icon:r(()=>[o(a(U))]),default:r(()=>[I(" "+x(a(h)("opts.exportAll")),1)]),_:1})]),f("div",null,[o(p,{tabKey:"example-enumer",value:y.value,"onUpdate:value":t[1]||(t[1]=n=>y.value=n),columns:a(L)},null,8,["value","columns"])])]),f("div",Q,[o(u,{class:"ant-table-striped","row-class-name":(n,m)=>m%2===1?"table-striped":null,bordered:"",size:"small",columns:y.value,"row-selection":a(V)("checkbox"),"row-key":n=>n.id,"data-source":T.value,pagination:a(s),loading:a(g),scroll:{y:a(E)},onChange:G},{bodyCell:r(({column:n,index:m})=>[n.dataIndex==="index"?(z(),B("a",ee,x((a(s).current-1)*a(s).pageSize+parseInt(m)+1),1)):H("",!0)]),_:1},8,["row-class-name","columns","row-selection","row-key","data-source","pagination","loading","scroll"])])]),_:1}),o(v,{show:_.value,"onUpdate:show":t[2]||(t[2]=n=>_.value=n),onSuccess:O,tempUrl:$.value},null,8,["show","tempUrl"])],64)}}});export{se as default};
