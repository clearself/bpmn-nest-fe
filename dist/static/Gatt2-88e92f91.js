import{d as M,e as t}from"./demoData-8d45b862.js";import B from"./index-741de866.js";import{t as F,_ as G}from"./index-5ec9320a.js";import{d as $,f as w,r as I,o as N,n as U,j as V,I as W,W as p,X as x,a0 as k,a1 as d,k as s,Z as r,F as y,a8 as j,Y as A,G as R,a6 as q,ac as P,ad as X}from"./vue-ced722ac.js";import"./antDesign-4a9bc9e2.js";import"./echarts-de64fab6.js";const f=m=>(P("data-v-5812f8f4"),m=m(),X(),m),Z={class:"my-gantt"},H={class:"time-box"},J={style:{height:"40px",position:"relative",overflow:"hidden"}},K=f(()=>d("div",{class:"nav-complated",style:{width:"14px",height:"14px",position:"relative",float:"left",top:"9px",border:"1px solid"}},null,-1)),O=f(()=>d("div",{class:"nav-ing",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)),Q=f(()=>d("div",{class:"nav-lag",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)),tt=f(()=>d("div",{class:"nav-warn",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)),et=f(()=>d("div",{class:"nav-normal",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)),at=f(()=>d("div",{id:"gantt_here",class:"gantt-container"},null,-1)),ot=$({__name:"Gatt2",setup(m,{expose:D}){const u=w(M),h=w({}),v=w(!1),l=I({timeList:[{name:"日",code:"day"},{name:"周",code:"week"},{name:"月",code:"month"}],show:!0,timeState:"day",demoData:{data:[]}}),b={levels:[{name:"day",scale_height:50,min_column_width:25,scales:[{unit:"month",format:"%Y-%m"},{unit:"day",step:1,format:"%d",css:function(e){return e.getDay()==0||e.getDay()==6?"day-item weekend weekend-border-bottom":"day-item"}}]},{name:"week",scale_height:50,min_column_width:110,scales:[{unit:"quarter",step:1,format:function(e){const a=new Date(e).getFullYear()+"年",o=t.date.date_to_str("%M"),n=t.date.add(t.date.add(e,3,"month"),-1,"day");return a+o(e)+" - "+o(n)}},{unit:"week",step:1,format:function(e){const a=t.date.date_to_str("%m-%d"),o=t.date.add(e,6,"day");return a(e)+" 至 "+a(o)}}]},{name:"month",scale_height:50,min_column_width:150,scales:[{unit:"year",step:1,format:"%Y年"},{unit:"month",format:"%Y-%m"}]}]},T=e=>{t.config.show_grid=e,g(u.value)},S=()=>{t.plugins({marker:!0,tooltip:!0}),t.config.start_date=new Date(new Date().getFullYear(),new Date().getMonth()-6,new Date().getDay()),t.config.end_date=new Date(new Date().getFullYear()+1,new Date().getMonth(),new Date().getDay()),t.config.show_grid=l.show,t.config.show_tasks_outside_timescale=!0;const e=t.date.date_to_str("%Y.%m.%d");t.config.grid_width=380,t.config.min_grid_column_width=150,t.config.bar_height=30,t.config.row_height=40,t.config.autofit=!0,t.config.fit_tasks=!0,t.config.auto_types=!0,t.config.xml_date="%Y.%m.%d",t.config.readonly=!1,t.config.show_errors=!1,t.config.show_empty_state=!0,t.config.open_split_tasks=!0,t.config.work_time=!0,t.config.smart_scales=!0,t.config.smart_rendering=!0,t.config.drag_links=!1,t.config.details_on_create=!0,t.config.resize_rows=!0,t.ext.draw=!0,t.templates.lightbox_header=function(a,o,n){return"<b>任务名称</b>"},t.templates.task_text=function(a,o,n){let i="";return n.status=="1"?i="lag":n.status=="3"?i="ing":n.status=="4"?i="warn":n.status=="2"?i="ccompleted":i="normal",` <div class="project-progress-${i}">${n.text}</div>`},t.config.columns=[{name:"text",label:"项目名称",resize:!0,tree:!0,align:"left",width:150},{name:"start_date",label:"开始时间",resize:!0,align:"center",width:150},{name:"duration",label:"工期",align:"center",width:70},{name:"progress",label:"进度",align:"center",width:50},{name:"add",width:44}],t.i18n.setLocale("cn"),t.ext.zoom.init(b),t.templates.timeline_cell_class=function(a,o){if(!t.isWorkTime({task:a,date:o}))return"weekend"},t.templates.scale_cell_class=function(a){if(!t.isWorkTime(a))return"weekend"},t.templates.tooltip_text=function(a,o,n){const i=Math.round(n.progress*100);return` <div>
          <div>项目名称：${n.text}</div>
          <div>开始时间：${e(n.start_date)}</div>
          <div>结束时间：${e(n.end_date)}</div>
          <div>进度：${i}%</div>
        </div>`},t.setSkin("meadow"),t.init("gantt_here"),g(u.value)},g=e=>{t.clearAll(),t.config.grid_width=380,t.config.min_grid_column_width=150,t.config.bar_height=30,t.config.row_height=40,t.addMarker({start_date:new Date,css:"today",text:"今日",title:F(new Date().getTime(),"YYYY-MM-DD")}),t.ext.zoom.setLevel("day"),t.parse(e),t.showDate(new Date)};t.attachEvent("onTaskLoading",function(e){return e.end_date&&(e.end_date=t.date.parseDate(e.end_date,"xml_date")),!0}),t.attachEvent("onTaskCreated",function(e){return e.text="任务名称",!0}),t.attachEvent("onAfterTaskDrag",function(e,a,o){return t.getTask(e),!1}),t.attachEvent("onLightboxSave",function(e,a,o){return a.status=1,a.users=[],a.open=!0,u.value.data.push(a),g(u.value),!0}),t.attachEvent("onTaskClick",function(e,a){return t.getTask(e),!0});const Y=e=>{u.value.data=u.value.data.map(a=>(a.id===h.value.id&&(a.progress=e.progress,a.status=e.status,a.users=e.users),a)),g(u.value)};t.attachEvent("onTaskDblClick",function(e,a){if(t.ext.tooltips.tooltip.hide(),a.target.className=="gantt_task_progress_wrapper"||a.target.className=="gantt_task_progress"){const o=t.getTask(e);return h.value=o,v.value=!0,!1}return!0}),t.attachEvent("onLightboxDelete",function(e){return t.getTask(e).duration>5?(alert("The duration is too long. Please, try again"),!1):!0});const C=()=>{t.ext.zoom.setLevel(l.timeState),t.showDate(new Date)};return N(()=>{U(()=>{S()})}),V(()=>{t.ext.tooltips.tooltip.hide()}),D({...W(l)}),(e,a)=>{const o=p("a-radio-button"),n=p("a-radio-group"),i=p("a-form-item"),_=p("a-tooltip"),L=p("a-switch"),z=p("a-form");return x(),k(y,null,[d("section",Z,[d("div",H,[s(z,{model:l,layout:"inline",style:{"margin-left":"15px"}},{default:r(()=>[s(i,{style:{"margin-left":"0px"}},{default:r(()=>[s(n,{value:l.timeState,"onUpdate:value":a[0]||(a[0]=c=>l.timeState=c),onChange:C},{default:r(()=>[(x(!0),k(y,null,j(l.timeList,(c,E)=>(x(),A(o,{key:E,value:c.code,size:"small",border:""},{default:r(()=>[R(q(c.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),s(i,null,{default:r(()=>[d("div",J,[s(_,{title:"已完成",placement:"top"},{default:r(()=>[K]),_:1}),s(_,{title:"进行中",placement:"top"},{default:r(()=>[O]),_:1}),s(_,{title:"未开始",placement:"top"},{default:r(()=>[Q]),_:1}),s(_,{title:"逾期",placement:"top"},{default:r(()=>[tt]),_:1}),s(_,{title:"正常",placement:"top"},{default:r(()=>[et]),_:1})])]),_:1}),s(i,null,{default:r(()=>[s(_,{title:"是否显示左侧列表",placement:"top"},{default:r(()=>[s(L,{checked:l.show,"onUpdate:checked":a[1]||(a[1]=c=>l.show=c),"checked-children":"是","un-checked-children":"否",onChange:T},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["model"])]),at]),s(B,{show:v.value,"onUpdate:show":a[2]||(a[2]=c=>v.value=c),task:h.value,onSuccess:Y},null,8,["show","task"])],64)}}});const ct=G(ot,[["__scopeId","data-v-5812f8f4"]]);export{ct as default};
