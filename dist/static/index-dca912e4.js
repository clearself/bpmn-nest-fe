import{j as oe,$ as s,t as le,n as se}from"./index-5ec9320a.js";import ne from"./formModel-be0a9d6a.js";import re from"./formDataModel-e4727465.js";import{i as ie,c as ue,g as U}from"./server-705dd836.js";import{d as de,f as b,r as M,o as ce,W as d,X as p,a0 as C,a1 as w,k as a,Z as l,u as t,G as x,a6 as m,a9 as f,Y as I,F as $,g as pe}from"./vue-ced722ac.js";import{i as me,m as _e}from"./antDesign-4a9bc9e2.js";import"./echarts-de64fab6.js";import"./server-221983a7.js";const fe=()=>({columns:[{lang:"columns.index",dataIndex:"index",width:50},{lang:"role.columns.roleName",dataIndex:"roleName",ellipsis:!0},{lang:"role.columns.roleKey",dataIndex:"roleKey",ellipsis:!0},{lang:"role.columns.state",dataIndex:"status",ellipsis:!0},{lang:"role.columns.createTime",dataIndex:"createTime",ellipsis:!0},{lang:"columns.operation",dataIndex:"operation"}]}),ve={class:"search-wrapper"},ye={class:"ub ub-ac ub-pj top-opt w100"},ge={class:"mt-1 w100",id:"roleTable"},we={key:0},xe={key:2},De=de({__name:"index",setup(P){const{proxy:V}=pe(),{sys_normal_disable:N}=V.useDict("sys_normal_disable"),{filterOption:O}=se(),{pagination:i,loading:v,scrollY:j}=oe(),{columns:A}=fe(),h=b(!1),z=b("add"),T=b(!1),K=b([]),D=b([]);let k=M({});const n=M({roleName:"",roleKey:"",status:void 0}),E=()=>{n.roleName="",n.roleKey="",n.status=void 0};ce(()=>{y()});const S=()=>{y()},L=r=>new Promise(async e=>{const c=await ue({id:r.roleId});(c==null?void 0:c.code)===200&&(_e.success(s("opeateSuccess")),y()),e(!0)}),Y=()=>{z.value="add",h.value=!0},G=async r=>{const e=await U(r.roleId);(e==null?void 0:e.code)===200&&(k=e.data,e.data,z.value="edit",h.value=!0)},R=async r=>{const e=await U(r.roleId);(e==null?void 0:e.code)===200&&(k=e.data,e.data,T.value=!0)},y=async()=>{v.value=!0;const r={roleName:n.roleName,roleKey:n.roleKey,status:n.status,pageNum:i.current,pageSize:i.pageSize},e=await ie(r);if((e==null?void 0:e.code)===200){v.value=!1;const{total:c=0,list:g=[]}=e.data;i.total=c,K.value=g}else v.value=!1},W=()=>{i.current=1,y()},X=()=>{i.current=1,E(),y()},Z=r=>{i.current=r.current,i.pageSize=r.pageSize,y()};return(r,e)=>{const c=d("a-input"),g=d("a-form-item"),q=d("a-select"),_=d("a-button"),H=d("a-form"),B=d("a-card"),J=d("fields-setting"),Q=d("dict-tag"),ee=d("a-popconfirm"),te=d("a-table");return p(),C($,null,[w("div",ve,[a(B,{size:"small"},{default:l(()=>[a(H,{model:n,layout:"inline"},{default:l(()=>[a(g,{label:t(s)("role.columns.roleName")},{default:l(()=>[a(c,{allowClear:"",value:n.roleName,"onUpdate:value":e[0]||(e[0]=o=>n.roleName=o),valueModifiers:{trim:!0},placeholder:t(s)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),a(g,{label:t(s)("role.columns.roleKey")},{default:l(()=>[a(c,{allowClear:"",value:n.roleKey,"onUpdate:value":e[1]||(e[1]=o=>n.roleKey=o),valueModifiers:{trim:!0},placeholder:t(s)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),a(g,{label:t(s)("role.columns.state")},{default:l(()=>[a(q,{"show-search":"","filter-option":t(O),options:t(N),allowClear:"",placeholder:t(s)("selectTips"),style:{width:"220px"},value:n.status,"onUpdate:value":e[2]||(e[2]=o=>n.status=o)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"]),a(g,null,{default:l(()=>[w("div",null,[a(_,{loading:t(v),type:"primary",onClick:W},{default:l(()=>[x(m(t(s)("opts.search")),1)]),_:1},8,["loading"]),a(_,{loading:t(v),class:"ml-1",onClick:X},{default:l(()=>[x(m(t(s)("opts.reset")),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1})]),w("div",ye,[w("div",null,[a(_,{size:"small",type:"primary",onClick:Y},{icon:l(()=>[a(t(me))]),default:l(()=>[x(" "+m(t(s)("opts.add")),1)]),_:1})]),w("div",null,[a(_,{type:"link",ref:"ref2",shape:"circle"},{default:l(()=>[a(J,{tabKey:"role-table",value:D.value,"onUpdate:value":e[3]||(e[3]=o=>D.value=o),columns:t(A)},null,8,["value","columns"])]),_:1},512)])]),a(B,{size:"small"},{default:l(()=>[w("div",ge,[a(te,{class:"ant-table-striped","row-class-name":(o,u)=>u%2===1?"table-striped":null,bordered:"",size:"small",columns:D.value,"row-key":o=>o.deptId,"data-source":K.value,pagination:t(i),loading:t(v),scroll:{y:t(j)},onChange:Z},{bodyCell:l(({column:o,record:u,index:ae})=>[o.dataIndex==="index"?(p(),C("a",we,m((t(i).current-1)*t(i).pageSize+parseInt(ae)+1),1)):f("",!0),o.dataIndex==="status"?(p(),I(Q,{key:1,options:t(N),value:u.status},null,8,["options","value"])):f("",!0),o.dataIndex==="createTime"?(p(),C("span",xe,m(t(le)(u.createTime)),1)):f("",!0),o.dataIndex==="operation"?(p(),C($,{key:3},[u.roleId!==1?(p(),I(_,{key:0,type:"link",size:"small",onClick:F=>G(u)},{default:l(()=>[x(m(t(s)("opts.edit")),1)]),_:2},1032,["onClick"])):f("",!0),u.roleId!==1?(p(),I(_,{key:1,type:"link",size:"small",onClick:F=>R(u)},{default:l(()=>[x(m(t(s)("role.opts.dataPermiss")),1)]),_:2},1032,["onClick"])):f("",!0),a(ee,{title:t(s)("sureTips"),"ok-text":t(s)("opts.sure"),"cancel-text":t(s)("opts.cancel"),onConfirm:F=>L(u)},{default:l(()=>[u.roleId!==1?(p(),I(_,{key:0,type:"link",size:"small",danger:""},{default:l(()=>[x(m(t(s)("opts.delete")),1)]),_:1})):f("",!0)]),_:2},1032,["title","ok-text","cancel-text","onConfirm"])],64)):f("",!0)]),_:1},8,["row-class-name","columns","row-key","data-source","pagination","loading","scroll"])])]),_:1}),a(ne,{show:h.value,"onUpdate:show":e[4]||(e[4]=o=>h.value=o),status:z.value,"cur-data":t(k),sysNormalDisable:t(N),onSuccess:S},null,8,["show","status","cur-data","sysNormalDisable"]),a(re,{show:T.value,"onUpdate:show":e[5]||(e[5]=o=>T.value=o),"cur-data":t(k),onSuccess:S},null,8,["show","cur-data"])],64)}}});export{De as default};
