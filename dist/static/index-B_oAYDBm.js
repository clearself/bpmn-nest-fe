import{l as ne,$ as l,x as oe,y as ue,o as re,z as de}from"./index-BeIH9SCz.js";import ie from"./formModel-CZRPCAjc.js";import ce from"./passwordModel-B6nByARc.js";import{i as pe,d as me,g as _e,b as fe}from"./server-DRtXPls8.js";import{h as ve,a as he}from"./antDesign-CdRSJcA9.js";import{d as be,f as y,r as O,o as ye,W as c,X as p,a0 as g,a1 as w,k as s,Z as n,u as e,G as x,a5 as m,a8 as _,Y as N,F as $,g as we}from"./vue-CuEiQHfR.js";import"./echarts-DSOc99Qa.js";const xe=()=>({columns:[{lang:"columns.index",dataIndex:"index",width:50},{lang:"user.columns.nickName",dataIndex:"nickName",ellipsis:!0},{lang:"user.columns.userName",dataIndex:"userName",ellipsis:!0},{lang:"user.columns.deptName",dataIndex:"deptName",ellipsis:!0},{lang:"user.columns.phonenumber",dataIndex:"phonenumber",ellipsis:!0},{lang:"user.columns.state",dataIndex:"status",ellipsis:!0},{lang:"user.columns.createTime",dataIndex:"createTime",ellipsis:!0},{lang:"columns.operation",dataIndex:"operation"}]}),ge={class:"search-wrapper"},ke={class:"ub ub-ac ub-pj top-opt w100"},Ie={class:"mt-1 w100",id:"userTable"},Ne={key:0},Ce={key:1},Te={key:3},$e=be({__name:"index",setup(M){const{proxy:V}=we(),{sys_normal_disable:C,sys_user_sex:A}=V.useDict("sys_normal_disable","sys_user_sex"),{filterOption:E}=ue(),{pagination:d,loading:h,scrollY:L}=ne(),{columns:Y}=xe(),T=y(!1),k=y(!1),z=y("add"),U=y([]),S=y([]),D=y([]);let I=O({});const o=O({userName:"",deptId:void 0,phonenumber:"",status:void 0}),j=()=>{o.userName="",o.deptId=void 0,o.phonenumber="",o.status=void 0};ye(()=>{b()});const P=()=>{b()},G=u=>new Promise(async t=>{const i=await me({id:u.userId});(i==null?void 0:i.code)===200&&(he.success(l("opeateSuccess")),b()),t(!0)}),K=()=>{z.value="add",k.value=!0},W=async u=>{const t=await _e(u.userId);(t==null?void 0:t.code)===200&&(I=t.data.data,z.value="edit",k.value=!0)},X=async u=>{I=u,T.value=!0};(async()=>{const u=await fe();(u==null?void 0:u.code)===200&&(S.value=u.data)})();const b=async()=>{h.value=!0;const u={userName:o.userName,deptId:o.deptId,phonenumber:o.phonenumber,status:o.status,pageNum:d.current,pageSize:d.pageSize},t=await pe(u);if((t==null?void 0:t.code)===200){h.value=!1;const{total:i=0,list:f=[]}=t.data;d.total=i,U.value=f}else h.value=!1},Z=()=>{d.current=1,b()},q=()=>{d.current=1,j(),b()},H=u=>{d.current=u.current,d.pageSize=u.pageSize,b()};return(u,t)=>{const i=c("a-input"),f=c("a-form-item"),J=c("a-tree-select"),Q=c("a-select"),v=c("a-button"),R=c("a-form"),B=c("a-card"),ee=re,te=de,ae=c("a-popconfirm"),se=c("a-table");return p(),g($,null,[w("div",ge,[s(B,{size:"small"},{default:n(()=>[s(R,{model:o,layout:"inline"},{default:n(()=>[s(f,{label:e(l)("user.columns.userName")},{default:n(()=>[s(i,{allowClear:"",value:o.userName,"onUpdate:value":t[0]||(t[0]=a=>o.userName=a),valueModifiers:{trim:!0},placeholder:e(l)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),s(f,{label:e(l)("user.columns.phonenumber")},{default:n(()=>[s(i,{allowClear:"",value:o.phonenumber,"onUpdate:value":t[1]||(t[1]=a=>o.phonenumber=a),valueModifiers:{trim:!0},placeholder:e(l)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),s(f,{label:e(l)("user.columns.deptName")},{default:n(()=>[s(J,{value:o.deptId,"onUpdate:value":t[2]||(t[2]=a=>o.deptId=a),placeholder:e(l)("selectTips"),"tree-data":S.value,"show-search":"","allow-clear":"","tree-default-expand-all":"",style:{width:"220px"},"tree-node-filter-prop":"label",fieldNames:{label:"label",value:"id",children:"children"}},null,8,["value","placeholder","tree-data"])]),_:1},8,["label"]),s(f,{label:e(l)("user.columns.state")},{default:n(()=>[s(Q,{"show-search":"","filter-option":e(E),options:e(C),allowClear:"",placeholder:e(l)("selectTips"),style:{width:"220px"},value:o.status,"onUpdate:value":t[3]||(t[3]=a=>o.status=a)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"]),s(f,null,{default:n(()=>[w("div",null,[s(v,{loading:e(h),type:"primary",onClick:Z},{default:n(()=>[x(m(e(l)("opts.search")),1)]),_:1},8,["loading"]),s(v,{loading:e(h),class:"ml-1",onClick:q},{default:n(()=>[x(m(e(l)("opts.reset")),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1})]),w("div",ke,[w("div",null,[s(v,{size:"small",type:"primary",onClick:K},{icon:n(()=>[s(e(ve))]),default:n(()=>[x(" "+m(e(l)("opts.add")),1)]),_:1})]),w("div",null,[s(v,{type:"link",ref:"ref2",shape:"circle"},{default:n(()=>[s(ee,{tabKey:"user-table",value:D.value,"onUpdate:value":t[4]||(t[4]=a=>D.value=a),columns:e(Y)},null,8,["value","columns"])]),_:1},512)])]),s(B,{size:"small"},{default:n(()=>[w("div",Ie,[s(se,{class:"ant-table-striped","row-class-name":(a,r)=>r%2===1?"table-striped":null,bordered:"",size:"small",columns:D.value,"row-key":a=>a.deptId,"data-source":U.value,pagination:e(d),loading:e(h),scroll:{y:e(L)},onChange:H},{bodyCell:n(({column:a,record:r,index:le})=>[a.dataIndex==="index"?(p(),g("a",Ne,m((e(d).current-1)*e(d).pageSize+parseInt(le)+1),1)):_("",!0),a.dataIndex==="deptName"?(p(),g("span",Ce,m(r.dept.deptName),1)):_("",!0),a.dataIndex==="status"?(p(),N(te,{key:2,options:e(C),value:r.status},null,8,["options","value"])):_("",!0),a.dataIndex==="createTime"?(p(),g("span",Te,m(e(oe)(r.createTime)),1)):_("",!0),a.dataIndex==="operation"?(p(),g($,{key:4},[r.userId!==1?(p(),N(v,{key:0,type:"link",size:"small",onClick:F=>W(r)},{default:n(()=>[x(m(e(l)("opts.edit")),1)]),_:2},1032,["onClick"])):_("",!0),r.userId!==1?(p(),N(v,{key:1,type:"link",size:"small",onClick:F=>X(r)},{default:n(()=>[x(m(e(l)("opts.changePassword")),1)]),_:2},1032,["onClick"])):_("",!0),s(ae,{title:e(l)("sureTips"),"ok-text":e(l)("opts.sure"),"cancel-text":e(l)("opts.cancel"),onConfirm:F=>G(r)},{default:n(()=>[r.userId!==1?(p(),N(v,{key:0,type:"link",size:"small",danger:""},{default:n(()=>[x(m(e(l)("opts.delete")),1)]),_:1})):_("",!0)]),_:2},1032,["title","ok-text","cancel-text","onConfirm"])],64)):_("",!0)]),_:1},8,["row-class-name","columns","row-key","data-source","pagination","loading","scroll"])])]),_:1}),s(ie,{show:k.value,"onUpdate:show":t[5]||(t[5]=a=>k.value=a),status:z.value,"cur-data":e(I),sysNormalDisable:e(C),sysUserSex:e(A),deptOptions:S.value,onSuccess:P},null,8,["show","status","cur-data","sysNormalDisable","sysUserSex","deptOptions"]),s(ce,{show:T.value,"onUpdate:show":t[6]||(t[6]=a=>T.value=a),"cur-data":e(I),onSuccess:P},null,8,["show","cur-data"])],64)}}});export{$e as default};
