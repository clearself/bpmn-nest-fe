import M from"./index-12695fac.js";import{t as B,_ as F}from"./index-8bef1c81.js";import{e as t}from"./dhtmlxgantt-e5dfe021.js";import{d as G,f as w,r as I,o as N,n as U,j,h as V,I as W,W as p,X as x,a0 as b,a1 as d,k as s,Z as i,F as k,a7 as A,Y as R,G as y,a5 as q,ae as P,af as X}from"./vue-d39115fd.js";import"./antDesign-5cb4b61a.js";import"./echarts-de64fab6.js";const Z=[{id:"001",parent:"0",text:"项目1",type:"project",render:"split",status:3,progress:.8,end_date:"2025-04-31",start_date:"2024-11-01",users:[{value:1,label:"张三"}],open:!0},{id:"0011",text:"项目1节点1",parent:"001",start_date:"2024-11-01",end_date:"2024-11-30",status:4,users:[{value:1,label:"张三"},{value:2,label:"李四"}],open:!0},{id:"0012",text:"项目1节点2",parent:"001",start_date:"2024-12-01",end_date:"2024-12-31",status:2,users:[{value:3,label:"王五"},{value:4,label:"赫六"}],open:!0},{id:"0013",text:"项目1节点3",parent:"001",start_date:"2025-01-01",end_date:"2025-01-31",status:2,users:[{value:4,label:"赫六"}],open:!0},{id:"0014",text:"项目1节点4",progress:.8,parent:"001",start_date:"2025-02-01",end_date:"2025-02-28",status:3,users:[{value:3,label:"王五"}],open:!0},{id:"0015",text:"项目1节点5",parent:"001",start_date:"2024-12-10",end_date:"2025-02-10",status:1,users:[{value:1,label:"张三"}],open:!0},{id:"0016",text:"项目1节点6",parent:"001",start_date:"2024-11-20",end_date:"2025-01-20",status:1,users:[{value:1,label:"张三"},{value:3,label:"王五"}],open:!0}],H={data:Z},m=f=>(P("data-v-b757b19c"),f=f(),X(),f),J={class:"my-gantt"},K={class:"time-box"},O={style:{height:"40px",position:"relative",overflow:"hidden"}},Q=m(()=>d("div",{class:"nav-complated",style:{width:"14px",height:"14px",position:"relative",float:"left",top:"9px",border:"1px solid"}},null,-1)),tt=m(()=>d("div",{class:"nav-ing",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)),et=m(()=>d("div",{class:"nav-lag",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)),at=m(()=>d("div",{class:"nav-warn",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)),nt=m(()=>d("div",{class:"nav-normal",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)),ot=m(()=>d("div",{id:"gantt_here",class:"gantt-container"},null,-1)),st=G({__name:"Gatt1",setup(f,{expose:D}){const c=w(H),h=w({}),v=w(!1),l=I({timeList:[{name:"日",code:"day"},{name:"周",code:"week"},{name:"月",code:"month"}],show:!0,timeState:"day",demoData:{data:[]}}),T={levels:[{name:"day",scale_height:50,min_column_width:25,scales:[{unit:"month",format:"%Y-%m"},{unit:"day",step:1,format:"%d",css:function(e){return e.getDay()==0||e.getDay()==6?"day-item weekend weekend-border-bottom":"day-item"}}]},{name:"week",scale_height:50,min_column_width:110,scales:[{unit:"quarter",step:1,format:function(e){const a=new Date(e).getFullYear()+"年",n=t.date.date_to_str("%M"),o=t.date.add(t.date.add(e,3,"month"),-1,"day");return a+n(e)+" - "+n(o)}},{unit:"week",step:1,format:function(e){const a=t.date.date_to_str("%m-%d"),n=t.date.add(e,6,"day");return a(e)+" 至 "+a(n)}}]},{name:"month",scale_height:50,min_column_width:150,scales:[{unit:"year",step:1,format:"%Y年"},{unit:"month",format:"%Y-%m"}]}]},S=e=>{t.config.show_grid=e,g(c.value)},Y=()=>{t.config.start_date=new Date(`${new Date().getFullYear()},${new Date().getMonth()-6},${new Date().getDay()}`),t.config.end_date=new Date(`${new Date().getFullYear()+1},${new Date().getMonth()},${new Date().getDay()}`),t.config.show_tasks_outside_timescale=!0;const e=t.date.date_to_str("%Y.%m.%d");t.config.grid_width=380,t.config.min_grid_column_width=150,t.config.autofit=!0,t.config.fit_tasks=!0,t.config.auto_types=!0,t.config.xml_date="%Y.%m.%d",t.config.readonly=!1,t.config.show_errors=!1,t.config.show_empty_state=!0,t.config.open_split_tasks=!0,t.config.work_time=!0,t.config.smart_scales=!0,t.config.smart_rendering=!0,t.config.drag_links=!1,t.config.details_on_create=!0,t.config.resize_rows=!0,t.config.show_grid=l.show,t.ext.draw=!0,t.templates.lightbox_header=function(a,n,o){return"<b>任务名称</b>"},t.templates.task_text=function(a,n,o){let r="";return o.status=="1"?r="lag":o.status=="3"?r="ing":o.status=="4"?r="warn":o.status=="2"?r="ccompleted":r="normal",` <div class="project-progress-${r}">${o.text}
</div>`},t.config.columns=[{name:"text",label:"项目名称",resize:!0,tree:!0,align:"left"},{name:"start_date",label:"开始时间",resize:!0,align:"center"},{name:"duration",label:"工期",align:"center",width:70},{name:"progress",label:"进度",align:"center",width:50},{name:"add",width:44}],t.i18n.setLocale("cn"),t.ext.zoom.init(T),t.plugins({marker:!0,tooltip:!0}),t.templates.timeline_cell_class=function(a,n){if(!t.isWorkTime({task:a,date:n}))return"weekend"},t.templates.scale_cell_class=function(a){if(!t.isWorkTime(a))return"weekend"},t.templates.tooltip_text=function(a,n,o){const r=Math.round(o.progress*100);return` <div>
          <div>项目名称：${o.text}</div>
          <div>开始时间：${e(o.start_date)}</div>
          <div>结束时间：${e(o.end_date)}</div>
          <div>进度：${r}%</div>
        </div>`},t.setSkin("meadow"),t.init("gantt_here"),t.config.grid_width=380,t.config.min_grid_column_width=150,t.config.row_height=40,g(c.value)},g=e=>{t.clearAll(),t.addMarker({start_date:new Date,css:"today",text:"今日",title:B(new Date().getTime(),"YYYY-MM-DD")}),t.ext.zoom.setLevel("day"),t.parse(e),t.showDate(new Date)};t.attachEvent("onTaskLoading",function(e){return e.end_date&&(e.end_date=t.date.parseDate(e.end_date,"xml_date")),!0}),t.attachEvent("onTaskCreated",function(e){return e.text="任务名称",!0}),t.attachEvent("onAfterTaskDrag",function(e,a,n){return t.getTask(e),!1}),t.attachEvent("onLightboxSave",function(e,a,n){return a.status=1,a.users=[],a.open=!0,c.value.data.push(a),g(c.value),!0}),t.attachEvent("onTaskClick",function(e,a){return t.getTask(e),!0});const $=e=>{c.value.data=c.value.data.map(a=>(a.id===h.value.id&&(a.progress=e.progress,a.status=e.status,a.users=e.users),a)),g(c.value)};t.attachEvent("onTaskDblClick",function(e,a){if(t.ext.tooltips.tooltip.hide(),a.target.className=="gantt_task_progress_wrapper"||a.target.className=="gantt_task_progress"){const n=t.getTask(e);return h.value=n,v.value=!0,!1}return!0}),t.attachEvent("onLightboxDelete",function(e){return t.getTask(e).duration>5?(alert("The duration is too long. Please, try again"),!1):!0});const C=()=>{t.ext.zoom.setLevel(l.timeState),t.showDate(new Date)};return N(()=>{U(()=>{Y()})}),j(()=>{t.ext.tooltips.tooltip.hide()}),V(()=>{}),D({...W(l)}),(e,a)=>{const n=p("a-radio-button"),o=p("a-radio-group"),r=p("a-form-item"),_=p("a-tooltip"),E=p("a-switch"),L=p("a-form");return x(),b(k,null,[d("section",J,[d("div",K,[s(L,{model:l,layout:"inline",style:{"margin-left":"15px"}},{default:i(()=>[s(r,{style:{"margin-left":"0px"}},{default:i(()=>[s(o,{value:l.timeState,"onUpdate:value":a[0]||(a[0]=u=>l.timeState=u),onChange:C},{default:i(()=>[(x(!0),b(k,null,A(l.timeList,(u,z)=>(x(),R(n,{key:z,value:u.code,size:"small",border:""},{default:i(()=>[y(q(u.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),s(r,null,{default:i(()=>[d("div",O,[s(_,{title:"已完成",placement:"top"},{default:i(()=>[Q]),_:1}),s(_,{title:"进行中",placement:"top"},{default:i(()=>[tt]),_:1}),s(_,{title:"未开始",placement:"top"},{default:i(()=>[et]),_:1}),s(_,{title:"逾期",placement:"top"},{default:i(()=>[at]),_:1}),s(_,{title:"正常",placement:"top"},{default:i(()=>[nt]),_:1})])]),_:1}),s(r,null,{default:i(()=>[s(_,{title:"是否显示左侧列表",placement:"top"},{default:i(()=>[s(E,{checked:l.show,"onUpdate:checked":a[1]||(a[1]=u=>l.show=u),"checked-children":"是","un-checked-children":"否",onChange:S},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["model"])]),ot]),s(M,{show:v.value,"onUpdate:show":a[2]||(a[2]=u=>v.value=u),task:h.value,onSuccess:$},null,8,["show","task"]),y("> ")],64)}}});const _t=F(st,[["__scopeId","data-v-b757b19c"]]);export{_t as default};
