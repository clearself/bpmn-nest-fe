import{j as Q,$ as o,t as ee,n as te}from"./index-c069a2e6.js";import ae from"./formModel-9ba0be85.js";import{i as se,d as ne}from"./server-0611e631.js";import{d as oe,f as g,r as S,o as le,W as u,X as c,a0 as x,a1 as f,k as t,Z as n,u as e,G as b,a5 as d,Y as C,a8 as v,F as T,g as ue}from"./vue-87dd1d62.js";import{j as ie,m as ce}from"./antDesign-ac8834bc.js";import"./echarts-de64fab6.js";const me=()=>({columns:[{lang:"menu.columns.menuName",dataIndex:"menuName",ellipsis:!0},{lang:"menu.columns.icon",dataIndex:"icon",ellipsis:!0},{lang:"menu.columns.sort",dataIndex:"orderNum",ellipsis:!0},{lang:"menu.columns.permissionIdentification",dataIndex:"perms",ellipsis:!0},{lang:"menu.columns.componentPath",dataIndex:"component",ellipsis:!0},{lang:"menu.columns.state",dataIndex:"status",ellipsis:!0},{lang:"menu.columns.createTime",dataIndex:"createTime",ellipsis:!0},{lang:"columns.operation",dataIndex:"operation",width:120}]}),de={class:"search-wrapper"},re={class:"ub ub-ac ub-pj top-opt w100"},pe={class:"mt-1 w100",id:"deptTable"},_e={key:0},fe={key:3},he=oe({__name:"index",setup(U){const{proxy:D}=ue(),{sys_normal_disable:h}=D.useDict("sys_normal_disable"),{filterOption:V}=te(),{loading:r,scrollY:$}=Q(),{columns:j}=me(),w=g(!1),k=g("add"),z=g([]),B=g(1),I=g([]);let F=S({});const i=S({menuName:"",status:void 0}),A=()=>{i.menuName="",i.status=void 0};le(()=>{y()});const E=()=>{y()},M=p=>new Promise(async s=>{const m=await ne({id:p.menuId});(m==null?void 0:m.code)===200&&(ce.success(o("opeateSuccess")),y()),s(!0)}),O=()=>{k.value="add",w.value=!0},K=p=>{F=p,k.value="edit",w.value=!0},y=async()=>{r.value=!0;const p={menuName:i.menuName,status:i.status},s=await se(p);if((s==null?void 0:s.code)===200){r.value=!1;const{data:m=[]}=s;B.value++,z.value=D.handleTree(m,"menuId")}else r.value=!1},L=()=>{y()},Y=()=>{A(),y()};return(p,s)=>{const m=u("a-input"),N=u("a-form-item"),G=u("a-select"),_=u("a-button"),R=u("a-form"),P=u("a-card"),W=u("fields-setting"),X=u("icon-svg"),Z=u("dict-tag"),q=u("a-popconfirm"),H=u("a-table");return c(),x(T,null,[f("div",de,[t(P,{size:"small"},{default:n(()=>[t(R,{model:i,layout:"inline"},{default:n(()=>[t(N,{label:e(o)("menu.columns.menuName")},{default:n(()=>[t(m,{allowClear:"",value:i.menuName,"onUpdate:value":s[0]||(s[0]=a=>i.menuName=a),valueModifiers:{trim:!0},placeholder:e(o)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),t(N,{label:e(o)("menu.columns.state")},{default:n(()=>[t(G,{"show-search":"","filter-option":e(V),options:e(h),allowClear:"",placeholder:e(o)("selectTips"),style:{width:"220px"},value:i.status,"onUpdate:value":s[1]||(s[1]=a=>i.status=a)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"]),t(N,null,{default:n(()=>[f("div",null,[t(_,{loading:e(r),type:"primary",onClick:L},{default:n(()=>[b(d(e(o)("opts.search")),1)]),_:1},8,["loading"]),t(_,{loading:e(r),class:"ml-1",onClick:Y},{default:n(()=>[b(d(e(o)("opts.reset")),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1})]),f("div",re,[f("div",null,[t(_,{size:"small",type:"primary",onClick:O},{icon:n(()=>[t(e(ie))]),default:n(()=>[b(" "+d(e(o)("opts.add")),1)]),_:1})]),f("div",null,[t(_,{type:"link",ref:"ref2",shape:"circle"},{default:n(()=>[t(W,{tabKey:"menu-table",value:I.value,"onUpdate:value":s[2]||(s[2]=a=>I.value=a),columns:e(j)},null,8,["value","columns"])]),_:1},512)])]),t(P,{size:"small"},{default:n(()=>[f("div",pe,[(c(),C(H,{key:B.value,defaultExpandAllRows:!1,class:"ant-table-striped","row-class-name":(a,l)=>l%2===1?"table-striped":null,bordered:"",size:"small",columns:I.value,"row-key":a=>a.menuId,"data-source":z.value,pagination:!1,loading:e(r),scroll:{y:e($)}},{bodyCell:n(({column:a,record:l})=>[a.dataIndex==="menuName"?(c(),x("span",_e,d(e(o)(l.menuName)),1)):v("",!0),a.dataIndex==="icon"?(c(),x(T,{key:1},[l!=null&&l.icon?(c(),C(X,{key:0,name:l.icon,width:"12",height:"12"},null,8,["name"])):v("",!0)],64)):v("",!0),a.dataIndex==="status"?(c(),C(Z,{key:2,options:e(h),value:l.status},null,8,["options","value"])):v("",!0),a.dataIndex==="createTime"?(c(),x("span",fe,d(e(ee)(l.createTime)),1)):v("",!0),a.dataIndex==="operation"?(c(),x(T,{key:4},[t(_,{type:"link",size:"small",onClick:J=>K(l)},{default:n(()=>[b(d(e(o)("opts.edit")),1)]),_:2},1032,["onClick"]),t(q,{title:e(o)("sureTips"),"ok-text":e(o)("opts.sure"),"cancel-text":e(o)("opts.cancel"),onConfirm:J=>M(l)},{default:n(()=>[t(_,{type:"link",size:"small",danger:""},{default:n(()=>[b(d(e(o)("opts.delete")),1)]),_:1})]),_:2},1032,["title","ok-text","cancel-text","onConfirm"])],64)):v("",!0)]),_:1},8,["row-class-name","columns","row-key","data-source","loading","scroll"]))])]),_:1}),t(ae,{show:w.value,"onUpdate:show":s[3]||(s[3]=a=>w.value=a),status:k.value,"cur-data":e(F),sysNormalDisable:e(h),onSuccess:E},null,8,["show","status","cur-data","sysNormalDisable"])],64)}}});export{he as default};
