import{r as c,$ as a,_ as j}from"./index-c069a2e6.js";import{d as q,f as I,r as D,h as P,c as R,W as m,X as h,Y as y,Z as n,k as s,u as o,a8 as A,a0 as G,F as L,a7 as W,G as z,a5 as H,g as X}from"./vue-87dd1d62.js";import{m as T}from"./antDesign-ac8834bc.js";const re=d=>c({method:"GET",url:"/system/dept/list",params:d}),oe=d=>c({method:"DELETE",url:`/system/dept/${d.id}`,params:d}),Y=d=>c({method:"POST",url:"/system/dept",data:d}),Z=d=>c({method:"PUT",url:"/system/dept",data:d}),J=()=>c({url:"/system/dept/list",method:"get"}),K=d=>c({url:"/system/dept/list/exclude/"+d,method:"get"}),Q=q({__name:"formModel",props:{show:{type:Boolean,default:!1},status:{type:String,default:"add"},curData:{type:Object,default:()=>{}},sysNormalDisable:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(d,{emit:x}){const{proxy:g}=X(),N=x,r=d,w=I(),b=I([]),e=D({deptId:"",parentId:void 0,deptName:"",orderNum:0,leader:"",phone:"",email:"",status:"0"}),C=()=>{e.deptId="",e.parentId=void 0,e.deptName="",e.orderNum=0,e.leader="",e.phone="",e.email="",e.status="0"},f=D({parentId:[{required:!0,message:a("selectTips"),trigger:["blur","change"]}],deptName:[{required:!0,message:a("inputTips"),trigger:"blur"}],orderNum:[{required:!0,message:a("inputTips"),trigger:"blur"}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]});P(()=>{r.show&&(r.status==="edit"?(e.deptId=r.curData.deptId,e.parentId=r.curData.parentId,e.deptName=r.curData.deptName,e.orderNum=r.curData.orderNum,e.leader=r.curData.leader,e.phone=r.curData.phone,e.email=r.curData.email,e.status=r.curData.status,S(r.curData.deptId)):k())});const k=async()=>{const u=await J();(u==null?void 0:u.code)===200&&(b.value=g.handleTree(u.data,"deptId"))},S=async u=>{const t=await K(u);(t==null?void 0:t.code)===200&&(b.value=g.handleTree(t.data,"deptId"))},v=R({get(){return r.show},set(u){N("update:show",u)}}),M=()=>{C()},U=async()=>{w.value.validate().then(async()=>{var t;const u={parentId:e.parentId,deptName:e.deptName,orderNum:e.orderNum,leader:e.leader,phone:e.phone,email:e.email,status:e.status};if(r.status==="edit"){u.deptId=(t=r==null?void 0:r.curData)==null?void 0:t.deptId;const p=await Z(u);(p==null?void 0:p.code)===200&&(v.value=!1,T.success(a("opeateSuccess")),N("success"))}else{const p=await Y(u);(p==null?void 0:p.code)===200&&(v.value=!1,T.success(a("opeateSuccess")),N("success"))}}).catch(u=>{})};return(u,t)=>{const p=m("a-tree-select"),i=m("a-form-item"),_=m("a-input"),E=m("a-input-number"),O=m("a-radio"),F=m("a-radio-group"),B=m("a-form"),V=m("watermark"),$=m("a-modal");return h(),y($,{destroyOnClose:"",open:v.value,"onUpdate:open":t[7]||(t[7]=l=>v.value=l),title:d.status==="add"?o(a)("opts.add"):o(a)("opts.edit"),width:"500px",cancelText:o(a)("opts.cancel"),okText:o(a)("opts.sure"),afterClose:M,onOk:U},{default:n(()=>[s(V,null,{default:n(()=>[s(B,{class:"w100",ref_key:"formRef",ref:w,model:e,labelWrap:"",labelCol:{style:{width:"110px"}}},{default:n(()=>[e.parentId!==0?(h(),y(i,{key:0,label:o(a)("dept.columns.preDeptName"),name:"parentId",rules:f.parentId},{default:n(()=>[s(p,{value:e.parentId,"onUpdate:value":t[0]||(t[0]=l=>e.parentId=l),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:o(a)("selectTips"),"allow-clear":"","tree-default-expand-all":"","tree-data":b.value,"field-names":{children:"children",label:"deptName",value:"deptId"},"tree-node-filter-prop":"deptName"},null,8,["value","placeholder","tree-data"])]),_:1},8,["label","rules"])):A("",!0),s(i,{label:o(a)("dept.columns.deptName"),name:"deptName",rules:f.deptName},{default:n(()=>[s(_,{allowClear:"",placeholder:o(a)("inputTips"),value:e.deptName,"onUpdate:value":t[1]||(t[1]=l=>e.deptName=l),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"]),s(i,{label:o(a)("dept.columns.showSort"),name:"orderNum",rules:f.orderNum},{default:n(()=>[s(E,{value:e.orderNum,"onUpdate:value":t[2]||(t[2]=l=>e.orderNum=l),min:0},null,8,["value"])]),_:1},8,["label","rules"]),s(i,{label:o(a)("dept.columns.leader")},{default:n(()=>[s(_,{allowClear:"",placeholder:o(a)("inputTips"),value:e.leader,"onUpdate:value":t[3]||(t[3]=l=>e.leader=l),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label"]),s(i,{label:o(a)("dept.columns.phone"),name:"phone",rules:f.phone},{default:n(()=>[s(_,{allowClear:"",placeholder:o(a)("inputTips"),value:e.phone,"onUpdate:value":t[4]||(t[4]=l=>e.phone=l),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"]),s(i,{label:o(a)("dept.columns.email")},{default:n(()=>[s(_,{allowClear:"",placeholder:o(a)("inputTips"),value:e.email,"onUpdate:value":t[5]||(t[5]=l=>e.email=l),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label"]),s(i,{label:o(a)("dept.columns.deptState")},{default:n(()=>[s(F,{value:e.status,"onUpdate:value":t[6]||(t[6]=l=>e.status=l),name:"deptState"},{default:n(()=>[(h(!0),G(L,null,W(d.sysNormalDisable,l=>(h(),y(O,{key:l.value,value:l.value},{default:n(()=>[z(H(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1})]),_:1},8,["open","title","cancelText","okText"])}}});const ee=j(Q,[["__scopeId","data-v-17e689f5"]]),se=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{ee as F,oe as d,se as f,re as i};
