import{$ as l,A as W,h as j,d as G}from"./index-BI1T92go.js";import{g as L,e as P,a as X}from"./server-CGwXUicS.js";import{a as T}from"./antDesign-wbdAq9hh.js";import{d as Y,f as N,r as C,h as Z,c as z,W as m,X as b,Y as w,Z as s,k as t,u as r,a8 as U,a0 as H,F as J,a7 as K,G as Q,a5 as ee}from"./vue-CuEiQHfR.js";import"./echarts-DSOc99Qa.js";const ae=Y({__name:"formModel",props:{show:{type:Boolean,default:!1},status:{type:String,default:"add"},curData:{type:Object,default:()=>{}},sysUserSex:{type:Array,default:()=>[]},sysNormalDisable:{type:Array,default:()=>[]},deptOptions:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(f,{emit:O}){const{filterOption:I}=W(),_=O,u=f,g=N(),x=N([]),y=N([]),e=C({userId:"",userName:"",nickName:"",deptId:void 0,phonenumber:"",email:"",password:"",sex:void 0,postIds:void 0,roleIds:void 0,status:"0",remark:""}),M=()=>{e.userId="",e.userName="",e.nickName="",e.deptId=void 0,e.phonenumber="",e.email="",e.password="",e.sex=void 0,e.postIds=void 0,e.roleIds=void 0,e.remark="",e.status="0"},v=C({nickName:[{required:!0,message:l("inputTips"),trigger:"blur"}],userName:[{required:!0,message:l("inputTips"),trigger:"blur"}],deptId:[{required:!0,message:l("selectTips"),trigger:["blur","change"]}],password:[{required:!0,message:l("inputTips"),trigger:"blur"},{min:5,max:20,message:l("placeholder25"),trigger:"blur"}],email:[{type:"email",message:l("placeholder26"),trigger:["blur","change"]}],phonenumber:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:l("placeholder27"),trigger:"blur"}]});Z(()=>{u.show&&(u.status==="edit"?(u.curData,e.userId=u.curData.userId,e.userName=u.curData.userName,e.nickName=u.curData.nickName,e.deptId=u.curData.deptId,e.phonenumber=u.curData.phonenumber,e.email=u.curData.email,e.sex=u.curData.sex,e.remark=u.curData.remark,e.status=u.curData.status,D(u.curData.userId)):D())});const D=async c=>{const a=await L(c);if((a==null?void 0:a.code)===200){const n=a.data,d=n.posts.filter(i=>i.status==="0");x.value=d.map(i=>({label:i.postName,value:i.postId}));const p=n.roles.filter(i=>i.roleId!==1&&i.status==="0");y.value=p.map(i=>({label:i.roleName,value:i.roleId})),c&&(e.postIds=n.postIds,e.roleIds=n.roleIds)}},h=z({get(){return u.show},set(c){_("update:show",c)}}),S=()=>{M()},F=async()=>{g.value.validate().then(async()=>{var c;if(u.status==="edit"){const a={nickName:e.nickName,deptId:e.deptId,phonenumber:e.phonenumber,email:e.email,sex:e.sex,postIds:e.postIds,roleIds:e.roleIds,remark:e.remark,status:e.status};a.userId=(c=u==null?void 0:u.curData)==null?void 0:c.userId;const n=await P(a);(n==null?void 0:n.code)===200&&(h.value=!1,T.success(l("opeateSuccess")),_("success"))}else{const a={userName:e.userName,password:e.password,nickName:e.nickName,deptId:e.deptId,phonenumber:e.phonenumber,email:e.email,sex:e.sex,postIds:e.postIds,roleIds:e.roleIds,remark:e.remark,status:e.status},n=await X(a);(n==null?void 0:n.code)===200&&(h.value=!1,T.success(l("opeateSuccess")),_("success"))}}).catch(c=>{})};return(c,a)=>{const n=m("a-input"),d=m("a-form-item"),p=m("a-col"),i=m("a-tree-select"),k=m("a-select"),q=m("a-radio"),A=m("a-radio-group"),B=m("a-textarea"),R=m("a-row"),V=m("a-form"),$=j,E=m("a-modal");return b(),w(E,{destroyOnClose:"",open:h.value,"onUpdate:open":a[11]||(a[11]=o=>h.value=o),title:f.status==="add"?r(l)("opts.add"):r(l)("opts.edit"),width:"800px",cancelText:r(l)("opts.cancel"),okText:r(l)("opts.sure"),afterClose:S,onOk:F},{default:s(()=>[t($,null,{default:s(()=>[t(V,{class:"w100",ref_key:"formRef",ref:g,model:e,labelWrap:"",labelCol:{style:{width:"100px"}}},{default:s(()=>[t(R,null,{default:s(()=>[t(p,{span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.nickName"),name:"nickName",rules:v.nickName},{default:s(()=>[t(n,{allowClear:"",placeholder:r(l)("inputTips"),value:e.nickName,"onUpdate:value":a[0]||(a[0]=o=>e.nickName=o),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.beDeptName"),name:"deptId",rules:v.deptId},{default:s(()=>[t(i,{value:e.deptId,"onUpdate:value":a[1]||(a[1]=o=>e.deptId=o),placeholder:r(l)("selectTips"),"tree-data":f.deptOptions,"show-search":"","allow-clear":"","tree-default-expand-all":"",style:{width:"100%"},"tree-node-filter-prop":"label",fieldNames:{label:"label",value:"id",children:"children"}},null,8,["value","placeholder","tree-data"])]),_:1},8,["label","rules"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.phonenumber"),name:"phonenumber",rules:v.phonenumber},{default:s(()=>[t(n,{allowClear:"",placeholder:r(l)("inputTips"),value:e.phonenumber,"onUpdate:value":a[2]||(a[2]=o=>e.phonenumber=o),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.email"),name:"email",rules:v.email},{default:s(()=>[t(n,{allowClear:"",placeholder:r(l)("inputTips"),value:e.email,"onUpdate:value":a[3]||(a[3]=o=>e.email=o),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1}),f.status==="add"?(b(),w(p,{key:0,span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.userName"),name:"userName",rules:v.userName},{default:s(()=>[t(n,{allowClear:"",placeholder:r(l)("inputTips"),value:e.userName,"onUpdate:value":a[4]||(a[4]=o=>e.userName=o),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1})):U("",!0),f.status==="add"?(b(),w(p,{key:1,span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.password"),name:"password",rules:v.password},{default:s(()=>[t(n,{allowClear:"",placeholder:r(l)("placeholder25"),value:e.password,"onUpdate:value":a[5]||(a[5]=o=>e.password=o),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1})):U("",!0),t(p,{span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.sex")},{default:s(()=>[t(k,{"show-search":"","filter-option":r(I),options:f.sysUserSex,allowClear:"",placeholder:r(l)("selectTips"),style:{width:"100%"},value:e.sex,"onUpdate:value":a[6]||(a[6]=o=>e.sex=o)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.state")},{default:s(()=>[t(A,{value:e.status,"onUpdate:value":a[7]||(a[7]=o=>e.status=o),name:"postState"},{default:s(()=>[(b(!0),H(J,null,K(f.sysNormalDisable,o=>(b(),w(q,{key:o.value,value:o.value},{default:s(()=>[Q(ee(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.post")},{default:s(()=>[t(k,{mode:"multiple","max-tag-count":2,"show-search":"","filter-option":r(I),options:x.value,allowClear:"",placeholder:r(l)("selectTips"),style:{width:"100%"},value:e.postIds,"onUpdate:value":a[8]||(a[8]=o=>e.postIds=o)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:r(l)("user.columns.role")},{default:s(()=>[t(k,{mode:"multiple","max-tag-count":2,"show-search":"","filter-option":r(I),options:y.value,allowClear:"",placeholder:r(l)("selectTips"),style:{width:"100%"},value:e.roleIds,"onUpdate:value":a[9]||(a[9]=o=>e.roleIds=o)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"])]),_:1}),t(p,{span:24},{default:s(()=>[t(d,{label:r(l)("user.columns.remark")},{default:s(()=>[t(B,{allowClear:"",placeholder:r(l)("inputTips"),value:e.remark,"onUpdate:value":a[10]||(a[10]=o=>e.remark=o),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["open","title","cancelText","okText"])}}}),ue=G(ae,[["__scopeId","data-v-6bd9d054"]]);export{ue as default};
