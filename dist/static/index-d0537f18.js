import{r as C,j as Z,$ as s,t as H,n as J}from"./index-bd69efc7.js";import{u as E,m as S}from"./antDesign-1cc9e1c8.js";import{d as Q,f as D,r as ee,o as te,W as r,X as b,a0 as I,a1 as g,k as t,Z as o,u as e,G as w,a6 as f,a9 as k,Y as ae,F as oe,g as se}from"./vue-ced722ac.js";import"./echarts-de64fab6.js";const ne=()=>({columns:[{lang:"columns.index",dataIndex:"index",width:50},{lang:"logininfo.columns.visitNo",dataIndex:"infoId",ellipsis:!0},{lang:"logininfo.columns.userName",dataIndex:"userName",ellipsis:!0},{lang:"logininfo.columns.address",dataIndex:"ipaddr",ellipsis:!0},{lang:"logininfo.columns.location",dataIndex:"loginLocation",ellipsis:!0},{lang:"logininfo.columns.system",dataIndex:"os",ellipsis:!0},{lang:"logininfo.columns.browser",dataIndex:"browser",ellipsis:!0},{lang:"logininfo.columns.state",dataIndex:"status",ellipsis:!0},{lang:"logininfo.columns.desc",dataIndex:"msg",ellipsis:!0},{lang:"logininfo.columns.visitTime",dataIndex:"loginTime",ellipsis:!0}]}),le=_=>C({method:"GET",url:"/monitor/logininfor/list",params:_}),ie=_=>C({method:"DELETE",url:`/monitor/logininfor/${_}`}),re=()=>C({method:"DELETE",url:"/monitor/logininfor/clean"}),ue={class:"search-wrapper"},ce={class:"ub ub-ac ub-pj top-opt w100"},de={class:"mt-1 w100",id:"logininforTable"},me={key:0},pe={key:2},xe=Q({__name:"index",setup(_){const{proxy:B}=se(),{sys_common_status:N}=B.useDict("sys_common_status"),{filterOption:F}=J(),{pagination:i,loading:d,scrollY:L,selectedRowKeys:x,rowSelection:U}=Z(),{columns:V}=ne(),T=D([]),h=D([]),l=ee({ipaddr:"",userName:"",status:void 0}),j=()=>{l.ipaddr="",l.userName="",l.status=void 0};te(()=>{m()});const M=()=>new Promise(async u=>{const a=x.value.join(","),c=await ie(a);(c==null?void 0:c.code)===200&&(x.value=[],S.success(s("opeateSuccess")),m()),u(!0)}),O=()=>new Promise(async u=>{const a=await re();(a==null?void 0:a.code)===200&&(x.value=[],S.success(s("opeateSuccess")),m()),u(!0)}),m=async()=>{d.value=!0;const u={ipaddr:l.ipaddr,userName:l.userName,status:l.status,pageNum:i.current,pageSize:i.pageSize,orderByColumn:"login_time",isAsc:"descending"},a=await le(u);if((a==null?void 0:a.code)===200){d.value=!1;const{total:c=0,list:p=[]}=a.data;i.total=c,T.value=p}else d.value=!1},P=()=>{i.current=1,m()},$=()=>{i.current=1,j(),m()},A=u=>{i.current=u.current,i.pageSize=u.pageSize,m()};return(u,a)=>{const c=r("a-input"),p=r("a-form-item"),G=r("a-select"),v=r("a-button"),K=r("a-form"),z=r("a-card"),Y=r("a-popconfirm"),q=r("fields-setting"),R=r("dict-tag"),W=r("a-table");return b(),I(oe,null,[g("div",ue,[t(z,{size:"small"},{default:o(()=>[t(K,{model:l,layout:"inline"},{default:o(()=>[t(p,{label:e(s)("logininfo.columns.address")},{default:o(()=>[t(c,{allowClear:"",value:l.ipaddr,"onUpdate:value":a[0]||(a[0]=n=>l.ipaddr=n),valueModifiers:{trim:!0},placeholder:e(s)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),t(p,{label:e(s)("logininfo.columns.userName")},{default:o(()=>[t(c,{allowClear:"",value:l.userName,"onUpdate:value":a[1]||(a[1]=n=>l.userName=n),valueModifiers:{trim:!0},placeholder:e(s)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),t(p,{label:e(s)("logininfo.columns.state")},{default:o(()=>[t(G,{"show-search":"","filter-option":e(F),options:e(N),allowClear:"",placeholder:e(s)("selectTips"),style:{width:"220px"},value:l.status,"onUpdate:value":a[2]||(a[2]=n=>l.status=n)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"]),t(p,null,{default:o(()=>[g("div",null,[t(v,{loading:e(d),type:"primary",onClick:P},{default:o(()=>[w(f(e(s)("opts.search")),1)]),_:1},8,["loading"]),t(v,{loading:e(d),class:"ml-1",onClick:$},{default:o(()=>[w(f(e(s)("opts.reset")),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1})]),g("div",ce,[g("div",null,[t(Y,{title:e(s)("sureTips"),"ok-text":e(s)("opts.sure"),"cancel-text":e(s)("opts.cancel"),onConfirm:O},{default:o(()=>[t(v,{size:"small",type:"primary",danger:""},{icon:o(()=>[t(e(E))]),default:o(()=>[w(" "+f(e(s)("opts.empty")),1)]),_:1})]),_:1},8,["title","ok-text","cancel-text"]),t(v,{class:"ml-1",disabled:e(x).length===0,size:"small",danger:"",onClick:M},{icon:o(()=>[t(e(E))]),default:o(()=>[w(" "+f(e(s)("opts.delete")),1)]),_:1},8,["disabled"])]),g("div",null,[t(v,{type:"link",ref:"ref2",shape:"circle"},{default:o(()=>[t(q,{tabKey:"logininfor-table",value:h.value,"onUpdate:value":a[3]||(a[3]=n=>h.value=n),columns:e(V)},null,8,["value","columns"])]),_:1},512)])]),t(z,{size:"small"},{default:o(()=>[g("div",de,[t(W,{class:"ant-table-striped","row-class-name":(n,y)=>y%2===1?"table-striped":null,bordered:"",size:"small",columns:h.value,"row-key":n=>n.infoId,"data-source":T.value,pagination:e(i),"row-selection":e(U)("checkbox"),loading:e(d),scroll:{y:e(L)},onChange:A},{bodyCell:o(({column:n,record:y,index:X})=>[n.dataIndex==="index"?(b(),I("a",me,f((e(i).current-1)*e(i).pageSize+parseInt(X)+1),1)):k("",!0),n.dataIndex==="status"?(b(),ae(R,{key:1,options:e(N),value:y.status},null,8,["options","value"])):k("",!0),n.dataIndex==="loginTime"?(b(),I("span",pe,f(e(H)(y.loginTime)),1)):k("",!0)]),_:1},8,["row-class-name","columns","row-key","data-source","pagination","row-selection","loading","scroll"])])]),_:1})],64)}}});export{xe as default};
