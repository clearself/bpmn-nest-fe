import{r as c,$ as a,f as j,b as q}from"./index-BeIH9SCz.js";import{a as I}from"./antDesign-CdRSJcA9.js";import{d as P,f as D,r as T,h as R,c as A,W as m,X as _,Y as y,Z as n,k as o,u as s,a8 as G,a0 as L,F as W,a7 as z,G as H,a5 as X,g as Y}from"./vue-CuEiQHfR.js";const se=d=>c({method:"GET",url:"/system/dept/list",params:d}),oe=d=>c({method:"DELETE",url:`/system/dept/${d.id}`,params:d}),Z=d=>c({method:"POST",url:"/system/dept",data:d}),J=d=>c({method:"PUT",url:"/system/dept",data:d}),K=()=>c({url:"/system/dept/list",method:"get"}),Q=d=>c({url:"/system/dept/list/exclude/"+d,method:"get"}),ee=P({__name:"formModel",props:{show:{type:Boolean,default:!1},status:{type:String,default:"add"},curData:{type:Object,default:()=>{}},sysNormalDisable:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(d,{emit:x}){const{proxy:g}=Y(),b=x,r=d,w=D(),N=D([]),e=T({deptId:"",parentId:void 0,deptName:"",orderNum:0,leader:"",phone:"",email:"",status:"0"}),C=()=>{e.deptId="",e.parentId=void 0,e.deptName="",e.orderNum=0,e.leader="",e.phone="",e.email="",e.status="0"},f=T({parentId:[{required:!0,message:a("selectTips"),trigger:["blur","change"]}],deptName:[{required:!0,message:a("inputTips"),trigger:"blur"}],orderNum:[{required:!0,message:a("inputTips"),trigger:"blur"}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]});R(()=>{r.show&&(r.status==="edit"?(e.deptId=r.curData.deptId,e.parentId=r.curData.parentId,e.deptName=r.curData.deptName,e.orderNum=r.curData.orderNum,e.leader=r.curData.leader,e.phone=r.curData.phone,e.email=r.curData.email,e.status=r.curData.status,S(r.curData.deptId)):k())});const k=async()=>{const u=await K();(u==null?void 0:u.code)===200&&(N.value=g.handleTree(u.data,"deptId"))},S=async u=>{const t=await Q(u);(t==null?void 0:t.code)===200&&(N.value=g.handleTree(t.data,"deptId"))},v=A({get(){return r.show},set(u){b("update:show",u)}}),U=()=>{C()},E=async()=>{w.value.validate().then(async()=>{var t;const u={parentId:e.parentId,deptName:e.deptName,orderNum:e.orderNum,leader:e.leader,phone:e.phone,email:e.email,status:e.status};if(r.status==="edit"){u.deptId=(t=r==null?void 0:r.curData)==null?void 0:t.deptId;const p=await J(u);(p==null?void 0:p.code)===200&&(v.value=!1,I.success(a("opeateSuccess")),b("success"))}else{const p=await Z(u);(p==null?void 0:p.code)===200&&(v.value=!1,I.success(a("opeateSuccess")),b("success"))}}).catch(u=>{})};return(u,t)=>{const p=m("a-tree-select"),i=m("a-form-item"),h=m("a-input"),M=m("a-input-number"),O=m("a-radio"),F=m("a-radio-group"),$=m("a-form"),B=j,V=m("a-modal");return _(),y(V,{destroyOnClose:"",open:v.value,"onUpdate:open":t[7]||(t[7]=l=>v.value=l),title:d.status==="add"?s(a)("opts.add"):s(a)("opts.edit"),width:"500px",cancelText:s(a)("opts.cancel"),okText:s(a)("opts.sure"),afterClose:U,onOk:E},{default:n(()=>[o(B,null,{default:n(()=>[o($,{class:"w100",ref_key:"formRef",ref:w,model:e,labelWrap:"",labelCol:{style:{width:"110px"}}},{default:n(()=>[e.parentId!==0?(_(),y(i,{key:0,label:s(a)("dept.columns.preDeptName"),name:"parentId",rules:f.parentId},{default:n(()=>[o(p,{value:e.parentId,"onUpdate:value":t[0]||(t[0]=l=>e.parentId=l),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:s(a)("selectTips"),"allow-clear":"","tree-default-expand-all":"","tree-data":N.value,"field-names":{children:"children",label:"deptName",value:"deptId"},"tree-node-filter-prop":"deptName"},null,8,["value","placeholder","tree-data"])]),_:1},8,["label","rules"])):G("",!0),o(i,{label:s(a)("dept.columns.deptName"),name:"deptName",rules:f.deptName},{default:n(()=>[o(h,{allowClear:"",placeholder:s(a)("inputTips"),value:e.deptName,"onUpdate:value":t[1]||(t[1]=l=>e.deptName=l),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"]),o(i,{label:s(a)("dept.columns.showSort"),name:"orderNum",rules:f.orderNum},{default:n(()=>[o(M,{value:e.orderNum,"onUpdate:value":t[2]||(t[2]=l=>e.orderNum=l),min:0},null,8,["value"])]),_:1},8,["label","rules"]),o(i,{label:s(a)("dept.columns.leader")},{default:n(()=>[o(h,{allowClear:"",placeholder:s(a)("inputTips"),value:e.leader,"onUpdate:value":t[3]||(t[3]=l=>e.leader=l),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label"]),o(i,{label:s(a)("dept.columns.phone"),name:"phone",rules:f.phone},{default:n(()=>[o(h,{allowClear:"",placeholder:s(a)("inputTips"),value:e.phone,"onUpdate:value":t[4]||(t[4]=l=>e.phone=l),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"]),o(i,{label:s(a)("dept.columns.email")},{default:n(()=>[o(h,{allowClear:"",placeholder:s(a)("inputTips"),value:e.email,"onUpdate:value":t[5]||(t[5]=l=>e.email=l),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label"]),o(i,{label:s(a)("dept.columns.deptState")},{default:n(()=>[o(F,{value:e.status,"onUpdate:value":t[6]||(t[6]=l=>e.status=l),name:"deptState"},{default:n(()=>[(_(!0),L(W,null,z(d.sysNormalDisable,l=>(_(),y(O,{key:l.value,value:l.value},{default:n(()=>[H(X(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1})]),_:1},8,["open","title","cancelText","okText"])}}}),te=q(ee,[["__scopeId","data-v-17e689f5"]]),de=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{te as F,oe as d,de as f,se as i};
