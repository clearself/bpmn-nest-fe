import{j as oe,$ as l,t as ne,l as re}from"./index-39ae9cb3.js";import ue from"./formModel-e7ae4935.js";import de from"./passwordModel-d3cfb7c5.js";import{i as ie,d as ce,g as pe,b as me}from"./server-d960361e.js";import{d as _e,f as y,r as O,o as fe,W as d,X as p,a0 as x,a1 as g,k as s,Z as o,u as e,G as w,a5 as m,a8 as _,Y as N,F as M,g as ve}from"./vue-58c0951e.js";import{j as be,m as he}from"./antDesign-96db8487.js";import"./echarts-de64fab6.js";const ye=()=>({columns:[{lang:"columns.index",dataIndex:"index",width:50},{lang:"user.columns.nickName",dataIndex:"nickName",ellipsis:!0},{lang:"user.columns.userName",dataIndex:"userName",ellipsis:!0},{lang:"user.columns.deptName",dataIndex:"deptName",ellipsis:!0},{lang:"user.columns.phonenumber",dataIndex:"phonenumber",ellipsis:!0},{lang:"user.columns.state",dataIndex:"status",ellipsis:!0},{lang:"user.columns.createTime",dataIndex:"createTime",ellipsis:!0},{lang:"columns.operation",dataIndex:"operation"}]}),ge={class:"search-wrapper"},we={class:"ub ub-ac ub-pj top-opt w100"},xe={class:"mt-1 w100",id:"userTable"},ke={key:0},Ie={key:1},Ne={key:3},Fe=_e({__name:"index",setup($){const{proxy:V}=ve(),{sys_normal_disable:C,sys_user_sex:j}=V.useDict("sys_normal_disable","sys_user_sex"),{filterOption:A}=re(),{pagination:i,loading:b,scrollY:E}=oe(),{columns:L}=ye(),T=y(!1),k=y(!1),S=y("add"),U=y([]),z=y([]),D=y([]);let I=O({});const n=O({userName:"",deptId:void 0,phonenumber:"",status:void 0}),Y=()=>{n.userName="",n.deptId=void 0,n.phonenumber="",n.status=void 0};fe(()=>{h()});const P=()=>{h()},G=r=>new Promise(async t=>{const c=await ce({id:r.userId});(c==null?void 0:c.code)===200&&(he.success(l("opeateSuccess")),h()),t(!0)}),K=()=>{S.value="add",k.value=!0},W=async r=>{const t=await pe(r.userId);(t==null?void 0:t.code)===200&&(I=t.data.data,S.value="edit",k.value=!0)},X=async r=>{I=r,T.value=!0};(async()=>{const r=await me();(r==null?void 0:r.code)===200&&(z.value=r.data)})();const h=async()=>{b.value=!0;const r={userName:n.userName,deptId:n.deptId,phonenumber:n.phonenumber,status:n.status,pageNum:i.current,pageSize:i.pageSize},t=await ie(r);if((t==null?void 0:t.code)===200){b.value=!1;const{total:c=0,list:f=[]}=t.data;i.total=c,U.value=f}else b.value=!1},Z=()=>{i.current=1,h()},q=()=>{i.current=1,Y(),h()},H=r=>{i.current=r.current,i.pageSize=r.pageSize,h()};return(r,t)=>{const c=d("a-input"),f=d("a-form-item"),J=d("a-tree-select"),Q=d("a-select"),v=d("a-button"),R=d("a-form"),B=d("a-card"),ee=d("fields-setting"),te=d("dict-tag"),ae=d("a-popconfirm"),se=d("a-table");return p(),x(M,null,[g("div",ge,[s(B,{size:"small"},{default:o(()=>[s(R,{model:n,layout:"inline"},{default:o(()=>[s(f,{label:e(l)("user.columns.userName")},{default:o(()=>[s(c,{allowClear:"",value:n.userName,"onUpdate:value":t[0]||(t[0]=a=>n.userName=a),valueModifiers:{trim:!0},placeholder:e(l)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),s(f,{label:e(l)("user.columns.phonenumber")},{default:o(()=>[s(c,{allowClear:"",value:n.phonenumber,"onUpdate:value":t[1]||(t[1]=a=>n.phonenumber=a),valueModifiers:{trim:!0},placeholder:e(l)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),s(f,{label:e(l)("user.columns.deptName")},{default:o(()=>[s(J,{value:n.deptId,"onUpdate:value":t[2]||(t[2]=a=>n.deptId=a),placeholder:e(l)("selectTips"),"tree-data":z.value,"show-search":"","allow-clear":"","tree-default-expand-all":"",style:{width:"220px"},"tree-node-filter-prop":"label",fieldNames:{label:"label",value:"id",children:"children"}},null,8,["value","placeholder","tree-data"])]),_:1},8,["label"]),s(f,{label:e(l)("user.columns.state")},{default:o(()=>[s(Q,{"show-search":"","filter-option":e(A),options:e(C),allowClear:"",placeholder:e(l)("selectTips"),style:{width:"220px"},value:n.status,"onUpdate:value":t[3]||(t[3]=a=>n.status=a)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"]),s(f,null,{default:o(()=>[g("div",null,[s(v,{loading:e(b),type:"primary",onClick:Z},{default:o(()=>[w(m(e(l)("opts.search")),1)]),_:1},8,["loading"]),s(v,{loading:e(b),class:"ml-1",onClick:q},{default:o(()=>[w(m(e(l)("opts.reset")),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1})]),g("div",we,[g("div",null,[s(v,{size:"small",type:"primary",onClick:K},{icon:o(()=>[s(e(be))]),default:o(()=>[w(" "+m(e(l)("opts.add")),1)]),_:1})]),g("div",null,[s(v,{type:"link",ref:"ref2",shape:"circle"},{default:o(()=>[s(ee,{tabKey:"user-table",value:D.value,"onUpdate:value":t[4]||(t[4]=a=>D.value=a),columns:e(L)},null,8,["value","columns"])]),_:1},512)])]),s(B,{size:"small"},{default:o(()=>[g("div",xe,[s(se,{class:"ant-table-striped","row-class-name":(a,u)=>u%2===1?"table-striped":null,bordered:"",size:"small",columns:D.value,"row-key":a=>a.deptId,"data-source":U.value,pagination:e(i),loading:e(b),scroll:{y:e(E)},onChange:H},{bodyCell:o(({column:a,record:u,index:le})=>[a.dataIndex==="index"?(p(),x("a",ke,m((e(i).current-1)*e(i).pageSize+parseInt(le)+1),1)):_("",!0),a.dataIndex==="deptName"?(p(),x("span",Ie,m(u.dept.deptName),1)):_("",!0),a.dataIndex==="status"?(p(),N(te,{key:2,options:e(C),value:u.status},null,8,["options","value"])):_("",!0),a.dataIndex==="createTime"?(p(),x("span",Ne,m(e(ne)(u.createTime)),1)):_("",!0),a.dataIndex==="operation"?(p(),x(M,{key:4},[u.userId!==1?(p(),N(v,{key:0,type:"link",size:"small",onClick:F=>W(u)},{default:o(()=>[w(m(e(l)("opts.edit")),1)]),_:2},1032,["onClick"])):_("",!0),u.userId!==1?(p(),N(v,{key:1,type:"link",size:"small",onClick:F=>X(u)},{default:o(()=>[w(m(e(l)("opts.changePassword")),1)]),_:2},1032,["onClick"])):_("",!0),s(ae,{title:e(l)("sureTips"),"ok-text":e(l)("opts.sure"),"cancel-text":e(l)("opts.cancel"),onConfirm:F=>G(u)},{default:o(()=>[u.userId!==1?(p(),N(v,{key:0,type:"link",size:"small",danger:""},{default:o(()=>[w(m(e(l)("opts.delete")),1)]),_:1})):_("",!0)]),_:2},1032,["title","ok-text","cancel-text","onConfirm"])],64)):_("",!0)]),_:1},8,["row-class-name","columns","row-key","data-source","pagination","loading","scroll"])])]),_:1}),s(ue,{show:k.value,"onUpdate:show":t[5]||(t[5]=a=>k.value=a),status:S.value,"cur-data":e(I),sysNormalDisable:e(C),sysUserSex:e(j),deptOptions:z.value,onSuccess:P},null,8,["show","status","cur-data","sysNormalDisable","sysUserSex","deptOptions"]),s(de,{show:T.value,"onUpdate:show":t[6]||(t[6]=a=>T.value=a),"cur-data":e(I),onSuccess:P},null,8,["show","cur-data"])],64)}}});export{Fe as default};
