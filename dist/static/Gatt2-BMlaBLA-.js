import{d as z,e as t}from"./demoData-DuG3GHGt.js";import E from"./index-CDmaNjDl.js";import{x as M,b as B}from"./index-BeIH9SCz.js";import{d as F,f as h,r as $,o as N,n as G,j as U,I as V,W as f,X as w,a0 as v,a1 as d,k as s,Z as r,F as x,a7 as W,Y as j,G as A,a5 as I}from"./vue-CuEiQHfR.js";import"./antDesign-CdRSJcA9.js";import"./echarts-DSOc99Qa.js";const R={class:"my-gantt"},q={class:"time-box"},P={style:{height:"40px",position:"relative",overflow:"hidden"}},X=F({__name:"Gatt2",setup(Z,{expose:k}){const c=h(z),g=h({}),_=h(!1),l=$({timeList:[{name:"日",code:"day"},{name:"周",code:"week"},{name:"月",code:"month"}],show:!0,timeState:"day",demoData:{data:[]}}),D={levels:[{name:"day",scale_height:50,min_column_width:25,scales:[{unit:"month",format:"%Y-%m"},{unit:"day",step:1,format:"%d",css:function(a){return a.getDay()==0||a.getDay()==6?"day-item weekend weekend-border-bottom":"day-item"}}]},{name:"week",scale_height:50,min_column_width:110,scales:[{unit:"quarter",step:1,format:function(a){const e=new Date(a).getFullYear()+"年",n=t.date.date_to_str("%M"),o=t.date.add(t.date.add(a,3,"month"),-1,"day");return e+n(a)+" - "+n(o)}},{unit:"week",step:1,format:function(a){const e=t.date.date_to_str("%m-%d"),n=t.date.add(a,6,"day");return e(a)+" 至 "+e(n)}}]},{name:"month",scale_height:50,min_column_width:150,scales:[{unit:"year",step:1,format:"%Y年"},{unit:"month",format:"%Y-%m"}]}]},y=a=>{t.config.show_grid=a,p(c.value)},b=()=>{t.plugins({marker:!0,tooltip:!0}),t.config.start_date=new Date(new Date().getFullYear(),new Date().getMonth()-6,new Date().getDay()),t.config.end_date=new Date(new Date().getFullYear()+1,new Date().getMonth(),new Date().getDay()),t.config.show_grid=l.show,t.config.show_tasks_outside_timescale=!0;const a=t.date.date_to_str("%Y.%m.%d");t.config.grid_width=380,t.config.min_grid_column_width=150,t.config.bar_height=30,t.config.row_height=40,t.config.autofit=!0,t.config.fit_tasks=!0,t.config.auto_types=!0,t.config.xml_date="%Y.%m.%d",t.config.readonly=!1,t.config.show_errors=!1,t.config.show_empty_state=!0,t.config.open_split_tasks=!0,t.config.work_time=!0,t.config.smart_scales=!0,t.config.smart_rendering=!0,t.config.drag_links=!1,t.config.details_on_create=!0,t.config.resize_rows=!0,t.ext.draw=!0,t.templates.lightbox_header=function(e,n,o){return"<b>任务名称</b>"},t.templates.task_text=function(e,n,o){let i="";return o.status=="1"?i="lag":o.status=="3"?i="ing":o.status=="4"?i="warn":o.status=="2"?i="ccompleted":i="normal",` <div class="project-progress-${i}">${o.text}</div>`},t.config.columns=[{name:"text",label:"项目名称",resize:!0,tree:!0,align:"left",width:150},{name:"start_date",label:"开始时间",resize:!0,align:"center",width:150},{name:"duration",label:"工期",align:"center",width:70},{name:"progress",label:"进度",align:"center",width:50},{name:"add",width:44}],t.i18n.setLocale("cn"),t.ext.zoom.init(D),t.templates.timeline_cell_class=function(e,n){if(!t.isWorkTime({task:e,date:n}))return"weekend"},t.templates.scale_cell_class=function(e){if(!t.isWorkTime(e))return"weekend"},t.templates.tooltip_text=function(e,n,o){const i=Math.round(o.progress*100);return` <div>
          <div>项目名称：${o.text}</div>
          <div>开始时间：${a(o.start_date)}</div>
          <div>结束时间：${a(o.end_date)}</div>
          <div>进度：${i}%</div>
        </div>`},t.setSkin("meadow"),t.init("gantt_here"),p(c.value)},p=a=>{t.clearAll(),t.config.grid_width=380,t.config.min_grid_column_width=150,t.config.bar_height=30,t.config.row_height=40,t.addMarker({start_date:new Date,css:"today",text:"今日",title:M(new Date().getTime(),"YYYY-MM-DD")}),t.ext.zoom.setLevel("day"),t.parse(a),t.showDate(new Date)};t.attachEvent("onTaskLoading",function(a){return a.end_date&&(a.end_date=t.date.parseDate(a.end_date,"xml_date")),!0}),t.attachEvent("onTaskCreated",function(a){return a.text="任务名称",!0}),t.attachEvent("onAfterTaskDrag",function(a,e,n){return t.getTask(a),!1}),t.attachEvent("onLightboxSave",function(a,e,n){return e.status=1,e.users=[],e.open=!0,c.value.data.push(e),p(c.value),!0}),t.attachEvent("onTaskClick",function(a,e){return t.getTask(a),!0});const T=a=>{c.value.data=c.value.data.map(e=>(e.id===g.value.id&&(e.progress=a.progress,e.status=a.status,e.users=a.users),e)),p(c.value)};t.attachEvent("onTaskDblClick",function(a,e){if(t.ext.tooltips.tooltip.hide(),e.target.className=="gantt_task_progress_wrapper"||e.target.className=="gantt_task_progress"){const n=t.getTask(a);return g.value=n,_.value=!0,!1}return!0}),t.attachEvent("onLightboxDelete",function(a){return t.getTask(a).duration>5?(alert("The duration is too long. Please, try again"),!1):!0});const S=()=>{t.ext.zoom.setLevel(l.timeState),t.showDate(new Date)};return N(()=>{G(()=>{b()})}),U(()=>{t.ext.tooltips.tooltip.hide()}),k({...V(l)}),(a,e)=>{const n=f("a-radio-button"),o=f("a-radio-group"),i=f("a-form-item"),m=f("a-tooltip"),Y=f("a-switch"),C=f("a-form");return w(),v(x,null,[d("section",R,[d("div",q,[s(C,{model:l,layout:"inline",style:{"margin-left":"15px"}},{default:r(()=>[s(i,{style:{"margin-left":"0px"}},{default:r(()=>[s(o,{value:l.timeState,"onUpdate:value":e[0]||(e[0]=u=>l.timeState=u),onChange:S},{default:r(()=>[(w(!0),v(x,null,W(l.timeList,(u,L)=>(w(),j(n,{key:L,value:u.code,size:"small",border:""},{default:r(()=>[A(I(u.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),s(i,null,{default:r(()=>[d("div",P,[s(m,{title:"已完成",placement:"top"},{default:r(()=>e[3]||(e[3]=[d("div",{class:"nav-complated",style:{width:"14px",height:"14px",position:"relative",float:"left",top:"9px",border:"1px solid"}},null,-1)])),_:1}),s(m,{title:"进行中",placement:"top"},{default:r(()=>e[4]||(e[4]=[d("div",{class:"nav-ing",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)])),_:1}),s(m,{title:"未开始",placement:"top"},{default:r(()=>e[5]||(e[5]=[d("div",{class:"nav-lag",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)])),_:1}),s(m,{title:"逾期",placement:"top"},{default:r(()=>e[6]||(e[6]=[d("div",{class:"nav-warn",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)])),_:1}),s(m,{title:"正常",placement:"top"},{default:r(()=>e[7]||(e[7]=[d("div",{class:"nav-normal",style:{width:"14px",height:"14px",position:"relative",float:"left","margin-left":"10px",top:"9px",border:"1px solid"}},null,-1)])),_:1})])]),_:1}),s(i,null,{default:r(()=>[s(m,{title:"是否显示左侧列表",placement:"top"},{default:r(()=>[s(Y,{checked:l.show,"onUpdate:checked":e[1]||(e[1]=u=>l.show=u),"checked-children":"是","un-checked-children":"否",onChange:y},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["model"])]),e[8]||(e[8]=d("div",{id:"gantt_here",class:"gantt-container"},null,-1))]),s(E,{show:_.value,"onUpdate:show":e[2]||(e[2]=u=>_.value=u),task:g.value,onSuccess:T},null,8,["show","task"])],64)}}}),et=B(X,[["__scopeId","data-v-5812f8f4"]]);export{et as default};
