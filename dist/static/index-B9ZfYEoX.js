import{o as X,$ as b,q as Y,w as Z,x as h,y as H}from"./index-CJd2VQGz.js";import{I as J,f as z,a as k}from"./antDesign-wbdAq9hh.js";import{d as M,f as d,W as S,X as U,a0 as $,k as o,Z as r,a1 as f,u as a,G as C,a5 as v,a8 as P,F as Q}from"./vue-CuEiQHfR.js";import"./echarts-DSOc99Qa.js";const j=()=>({columns:[{lang:"columns.index",dataIndex:"index",fixed:"left",width:50},{lang:"example.columns.name",dataIndex:"name",ellipsis:!0},{lang:"example.columns.content",dataIndex:"content",ellipsis:!0}]}),ee={class:"ub ub-ac ub-pj top-opt w100"},te={class:"mt-1 w100"},ae={key:0},re=M({__name:"index",setup(B){const{pagination:s,scrollY:D,loading:x,selectedRows:I,rowSelection:E,clearTableSelected:V}=X(),{columns:F}=j(),L=d("https://www.flypa.cn/dataTemplate.xlsx"),g=d([]),y=d(""),_=d(!1),T=d([]),i=d([]),O=async e=>{V(),i.value=e.list,y.value=e.fileName,_.value=!1,A()},A=()=>{x.value=!0,setTimeout(()=>{const e=(s.current-1)*s.pageSize,t=e+s.pageSize,l=i.value.slice(e,t),p={total:i.value.length,records:l};x.value=!1;const{total:u,records:c}=p;s.total=u,T.value=c},500)},q=e=>{s.current=e.current,s.pageSize=e.pageSize,A()},N=(e,t,l,p,u)=>{let c=[];if(!Array.isArray(e))return console.warn("数据请传入数组");if(!Array.isArray(l))return console.warn("标题请传入数组");if(!Array.isArray(u))return console.warn("字段请传入数组");c=e.map(R=>u.map(W=>R[W])),c.splice(0,0,l);const w=h.aoa_to_sheet(c),n=h.book_new(),m=[{hidden:!1}];w["!rows"]=m,h.book_append_sheet(n,w,p),H(n,t+".xlsx")},G=()=>{if(i.value.length===0){k.warning("请先导入数据");return}if(I.value.length===0){k.warning("请至少选择一条数据");return}const e=["名称","内容"],t=["name","content"];N(I.value,y.value,e,"sheetName",t)},K=()=>{if(i.value.length===0){k.warning("请先导入数据");return}const e=["名称","内容"],t=["name","content"];N(i.value,y.value,e,"sheetName",t)};return(e,t)=>{const l=S("a-button"),p=Y,u=S("a-table"),c=S("a-card"),w=Z;return U(),$(Q,null,[o(c,{size:"small"},{default:r(()=>[f("div",ee,[f("div",null,[o(l,{type:"primary",onClick:t[0]||(t[0]=n=>_.value=!0)},{icon:r(()=>[o(a(J))]),default:r(()=>[C(" "+v(a(b)("opts.import")),1)]),_:1}),o(l,{class:"ml-1",type:"primary",onClick:G},{icon:r(()=>[o(a(z))]),default:r(()=>[C(" "+v(a(b)("opts.exportSelected")),1)]),_:1}),o(l,{class:"ml-1",type:"primary",onClick:K},{icon:r(()=>[o(a(z))]),default:r(()=>[C(" "+v(a(b)("opts.exportAll")),1)]),_:1})]),f("div",null,[o(p,{tabKey:"example-enumer",value:g.value,"onUpdate:value":t[1]||(t[1]=n=>g.value=n),columns:a(F)},null,8,["value","columns"])])]),f("div",te,[o(u,{class:"ant-table-striped","row-class-name":(n,m)=>m%2===1?"table-striped":null,bordered:"",size:"small",columns:g.value,"row-selection":a(E)("checkbox"),"row-key":n=>n.id,"data-source":T.value,pagination:a(s),loading:a(x),scroll:{y:a(D)},onChange:q},{bodyCell:r(({column:n,index:m})=>[n.dataIndex==="index"?(U(),$("a",ae,v((a(s).current-1)*a(s).pageSize+parseInt(m)+1),1)):P("",!0)]),_:1},8,["row-class-name","columns","row-selection","row-key","data-source","pagination","loading","scroll"])])]),_:1}),o(w,{show:_.value,"onUpdate:show":t[2]||(t[2]=n=>_.value=n),onSuccess:O,tempUrl:L.value},null,8,["show","tempUrl"])],64)}}});export{re as default};
