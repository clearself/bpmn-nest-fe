import{r as C,o as Z,$ as n,z as H,A as J,q as Q,B as ee}from"./index-BI1T92go.js";import{u as E,a as S}from"./antDesign-wbdAq9hh.js";import{d as te,f as D,r as ae,o as oe,W as c,X as b,a0 as I,a1 as _,k as t,Z as o,u as e,G as w,a5 as f,a8 as k,Y as ne,F as se,g as le}from"./vue-CuEiQHfR.js";import"./echarts-DSOc99Qa.js";const ie=()=>({columns:[{lang:"columns.index",dataIndex:"index",width:50},{lang:"logininfo.columns.visitNo",dataIndex:"infoId",ellipsis:!0},{lang:"logininfo.columns.userName",dataIndex:"userName",ellipsis:!0},{lang:"logininfo.columns.address",dataIndex:"ipaddr",ellipsis:!0},{lang:"logininfo.columns.location",dataIndex:"loginLocation",ellipsis:!0},{lang:"logininfo.columns.system",dataIndex:"os",ellipsis:!0},{lang:"logininfo.columns.browser",dataIndex:"browser",ellipsis:!0},{lang:"logininfo.columns.state",dataIndex:"status",ellipsis:!0},{lang:"logininfo.columns.desc",dataIndex:"msg",ellipsis:!0},{lang:"logininfo.columns.visitTime",dataIndex:"loginTime",ellipsis:!0}]}),re=g=>C({method:"GET",url:"/monitor/logininfor/list",params:g}),ue=g=>C({method:"DELETE",url:`/monitor/logininfor/${g}`}),ce=()=>C({method:"DELETE",url:"/monitor/logininfor/clean"}),de={class:"search-wrapper"},me={class:"ub ub-ac ub-pj top-opt w100"},pe={class:"mt-1 w100",id:"logininforTable"},_e={key:0},fe={key:2},be=te({__name:"index",setup(g){const{proxy:B}=le(),{sys_common_status:N}=B.useDict("sys_common_status"),{filterOption:F}=J(),{pagination:i,loading:d,scrollY:L,selectedRowKeys:x,rowSelection:U}=Z(),{columns:V}=ie(),T=D([]),h=D([]),l=ae({ipaddr:"",userName:"",status:void 0}),$=()=>{l.ipaddr="",l.userName="",l.status=void 0};oe(()=>{m()});const A=()=>new Promise(async r=>{const a=x.value.join(","),u=await ue(a);(u==null?void 0:u.code)===200&&(x.value=[],S.success(n("opeateSuccess")),m()),r(!0)}),M=()=>new Promise(async r=>{const a=await ce();(a==null?void 0:a.code)===200&&(x.value=[],S.success(n("opeateSuccess")),m()),r(!0)}),m=async()=>{d.value=!0;const r={ipaddr:l.ipaddr,userName:l.userName,status:l.status,pageNum:i.current,pageSize:i.pageSize,orderByColumn:"login_time",isAsc:"descending"},a=await re(r);if((a==null?void 0:a.code)===200){d.value=!1;const{total:u=0,list:p=[]}=a.data;i.total=u,T.value=p}else d.value=!1},O=()=>{i.current=1,m()},P=()=>{i.current=1,$(),m()},j=r=>{i.current=r.current,i.pageSize=r.pageSize,m()};return(r,a)=>{const u=c("a-input"),p=c("a-form-item"),q=c("a-select"),v=c("a-button"),G=c("a-form"),z=c("a-card"),K=c("a-popconfirm"),Y=Q,R=ee,W=c("a-table");return b(),I(se,null,[_("div",de,[t(z,{size:"small"},{default:o(()=>[t(G,{model:l,layout:"inline"},{default:o(()=>[t(p,{label:e(n)("logininfo.columns.address")},{default:o(()=>[t(u,{allowClear:"",value:l.ipaddr,"onUpdate:value":a[0]||(a[0]=s=>l.ipaddr=s),valueModifiers:{trim:!0},placeholder:e(n)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),t(p,{label:e(n)("logininfo.columns.userName")},{default:o(()=>[t(u,{allowClear:"",value:l.userName,"onUpdate:value":a[1]||(a[1]=s=>l.userName=s),valueModifiers:{trim:!0},placeholder:e(n)("inputTips"),style:{width:"220px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),t(p,{label:e(n)("logininfo.columns.state")},{default:o(()=>[t(q,{"show-search":"","filter-option":e(F),options:e(N),allowClear:"",placeholder:e(n)("selectTips"),style:{width:"220px"},value:l.status,"onUpdate:value":a[2]||(a[2]=s=>l.status=s)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"]),t(p,null,{default:o(()=>[_("div",null,[t(v,{loading:e(d),type:"primary",onClick:O},{default:o(()=>[w(f(e(n)("opts.search")),1)]),_:1},8,["loading"]),t(v,{loading:e(d),class:"ml-1",onClick:P},{default:o(()=>[w(f(e(n)("opts.reset")),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1})]),_("div",me,[_("div",null,[t(K,{title:e(n)("sureTips"),"ok-text":e(n)("opts.sure"),"cancel-text":e(n)("opts.cancel"),onConfirm:M},{default:o(()=>[t(v,{size:"small",type:"primary",danger:""},{icon:o(()=>[t(e(E))]),default:o(()=>[w(" "+f(e(n)("opts.empty")),1)]),_:1})]),_:1},8,["title","ok-text","cancel-text"]),t(v,{class:"ml-1",disabled:e(x).length===0,size:"small",danger:"",onClick:A},{icon:o(()=>[t(e(E))]),default:o(()=>[w(" "+f(e(n)("opts.delete")),1)]),_:1},8,["disabled"])]),_("div",null,[t(v,{type:"link",ref:"ref2",shape:"circle"},{default:o(()=>[t(Y,{tabKey:"logininfor-table",value:h.value,"onUpdate:value":a[3]||(a[3]=s=>h.value=s),columns:e(V)},null,8,["value","columns"])]),_:1},512)])]),t(z,{size:"small"},{default:o(()=>[_("div",pe,[t(W,{class:"ant-table-striped","row-class-name":(s,y)=>y%2===1?"table-striped":null,bordered:"",size:"small",columns:h.value,"row-key":s=>s.infoId,"data-source":T.value,pagination:e(i),"row-selection":e(U)("checkbox"),loading:e(d),scroll:{y:e(L)},onChange:j},{bodyCell:o(({column:s,record:y,index:X})=>[s.dataIndex==="index"?(b(),I("a",_e,f((e(i).current-1)*e(i).pageSize+parseInt(X)+1),1)):k("",!0),s.dataIndex==="status"?(b(),ne(R,{key:1,options:e(N),value:y.status},null,8,["options","value"])):k("",!0),s.dataIndex==="loginTime"?(b(),I("span",fe,f(e(H)(y.loginTime)),1)):k("",!0)]),_:1},8,["row-class-name","columns","row-key","data-source","pagination","row-selection","loading","scroll"])])]),_:1})],64)}}});export{be as default};
