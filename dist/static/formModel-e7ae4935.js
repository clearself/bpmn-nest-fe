import{$ as l,l as W,_ as j}from"./index-39ae9cb3.js";import{g as G,e as L,a as P}from"./server-d960361e.js";import{d as X,f as g,r as T,h as Y,c as Z,W as m,X as b,Y as w,Z as s,k as t,u as o,a8 as C,a0 as z,F as H,a7 as J,G as K,a5 as Q}from"./vue-58c0951e.js";import{m as U}from"./antDesign-96db8487.js";import"./echarts-de64fab6.js";const ee=X({__name:"formModel",props:{show:{type:Boolean,default:!1},status:{type:String,default:"add"},curData:{type:Object,default:()=>{}},sysUserSex:{type:Array,default:()=>[]},sysNormalDisable:{type:Array,default:()=>[]},deptOptions:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(f,{emit:O}){const{filterOption:h}=W(),I=O,u=f,N=g(),x=g([]),y=g([]),e=T({userId:"",userName:"",nickName:"",deptId:void 0,phonenumber:"",email:"",password:"",sex:void 0,postIds:void 0,roleIds:void 0,status:"0",remark:""}),M=()=>{e.userId="",e.userName="",e.nickName="",e.deptId=void 0,e.phonenumber="",e.email="",e.password="",e.sex=void 0,e.postIds=void 0,e.roleIds=void 0,e.remark="",e.status="0"},v=T({nickName:[{required:!0,message:l("inputTips"),trigger:"blur"}],userName:[{required:!0,message:l("inputTips"),trigger:"blur"}],deptId:[{required:!0,message:l("selectTips"),trigger:["blur","change"]}],password:[{required:!0,message:l("inputTips"),trigger:"blur"},{min:5,max:20,message:l("placeholder25"),trigger:"blur"}],email:[{type:"email",message:l("placeholder26"),trigger:["blur","change"]}],phonenumber:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:l("placeholder27"),trigger:"blur"}]});Y(()=>{u.show&&(u.status==="edit"?(u.curData,e.userId=u.curData.userId,e.userName=u.curData.userName,e.nickName=u.curData.nickName,e.deptId=u.curData.deptId,e.phonenumber=u.curData.phonenumber,e.email=u.curData.email,e.sex=u.curData.sex,e.remark=u.curData.remark,e.status=u.curData.status,D(u.curData.userId)):D())});const D=async c=>{const a=await G(c);if((a==null?void 0:a.code)===200){const n=a.data,d=n.posts.filter(i=>i.status==="0");x.value=d.map(i=>({label:i.postName,value:i.postId}));const p=n.roles.filter(i=>i.roleId!==1&&i.status==="0");y.value=p.map(i=>({label:i.roleName,value:i.roleId})),c&&(e.postIds=n.postIds,e.roleIds=n.roleIds)}},_=Z({get(){return u.show},set(c){I("update:show",c)}}),S=()=>{M()},F=async()=>{N.value.validate().then(async()=>{var c;if(u.status==="edit"){const a={nickName:e.nickName,deptId:e.deptId,phonenumber:e.phonenumber,email:e.email,sex:e.sex,postIds:e.postIds,roleIds:e.roleIds,remark:e.remark,status:e.status};a.userId=(c=u==null?void 0:u.curData)==null?void 0:c.userId;const n=await L(a);(n==null?void 0:n.code)===200&&(_.value=!1,U.success(l("opeateSuccess")),I("success"))}else{const a={userName:e.userName,password:e.password,nickName:e.nickName,deptId:e.deptId,phonenumber:e.phonenumber,email:e.email,sex:e.sex,postIds:e.postIds,roleIds:e.roleIds,remark:e.remark,status:e.status},n=await P(a);(n==null?void 0:n.code)===200&&(_.value=!1,U.success(l("opeateSuccess")),I("success"))}}).catch(c=>{})};return(c,a)=>{const n=m("a-input"),d=m("a-form-item"),p=m("a-col"),i=m("a-tree-select"),k=m("a-select"),q=m("a-radio"),B=m("a-radio-group"),R=m("a-textarea"),V=m("a-row"),A=m("a-form"),$=m("watermark"),E=m("a-modal");return b(),w(E,{destroyOnClose:"",open:_.value,"onUpdate:open":a[11]||(a[11]=r=>_.value=r),title:f.status==="add"?o(l)("opts.add"):o(l)("opts.edit"),width:"800px",cancelText:o(l)("opts.cancel"),okText:o(l)("opts.sure"),afterClose:S,onOk:F},{default:s(()=>[t($,null,{default:s(()=>[t(A,{class:"w100",ref_key:"formRef",ref:N,model:e,labelWrap:"",labelCol:{style:{width:"100px"}}},{default:s(()=>[t(V,null,{default:s(()=>[t(p,{span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.nickName"),name:"nickName",rules:v.nickName},{default:s(()=>[t(n,{allowClear:"",placeholder:o(l)("inputTips"),value:e.nickName,"onUpdate:value":a[0]||(a[0]=r=>e.nickName=r),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.beDeptName"),name:"deptId",rules:v.deptId},{default:s(()=>[t(i,{value:e.deptId,"onUpdate:value":a[1]||(a[1]=r=>e.deptId=r),placeholder:o(l)("selectTips"),"tree-data":f.deptOptions,"show-search":"","allow-clear":"","tree-default-expand-all":"",style:{width:"100%"},"tree-node-filter-prop":"label",fieldNames:{label:"label",value:"id",children:"children"}},null,8,["value","placeholder","tree-data"])]),_:1},8,["label","rules"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.phonenumber"),name:"phonenumber",rules:v.phonenumber},{default:s(()=>[t(n,{allowClear:"",placeholder:o(l)("inputTips"),value:e.phonenumber,"onUpdate:value":a[2]||(a[2]=r=>e.phonenumber=r),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.email"),name:"email",rules:v.email},{default:s(()=>[t(n,{allowClear:"",placeholder:o(l)("inputTips"),value:e.email,"onUpdate:value":a[3]||(a[3]=r=>e.email=r),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1}),f.status==="add"?(b(),w(p,{key:0,span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.userName"),name:"userName",rules:v.userName},{default:s(()=>[t(n,{allowClear:"",placeholder:o(l)("inputTips"),value:e.userName,"onUpdate:value":a[4]||(a[4]=r=>e.userName=r),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1})):C("",!0),f.status==="add"?(b(),w(p,{key:1,span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.password"),name:"password",rules:v.password},{default:s(()=>[t(n,{allowClear:"",placeholder:o(l)("placeholder25"),value:e.password,"onUpdate:value":a[5]||(a[5]=r=>e.password=r),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label","rules"])]),_:1})):C("",!0),t(p,{span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.sex")},{default:s(()=>[t(k,{"show-search":"","filter-option":o(h),options:f.sysUserSex,allowClear:"",placeholder:o(l)("selectTips"),style:{width:"100%"},value:e.sex,"onUpdate:value":a[6]||(a[6]=r=>e.sex=r)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.state")},{default:s(()=>[t(B,{value:e.status,"onUpdate:value":a[7]||(a[7]=r=>e.status=r),name:"postState"},{default:s(()=>[(b(!0),z(H,null,J(f.sysNormalDisable,r=>(b(),w(q,{key:r.value,value:r.value},{default:s(()=>[K(Q(r.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.post")},{default:s(()=>[t(k,{mode:"multiple","max-tag-count":2,"show-search":"","filter-option":o(h),options:x.value,allowClear:"",placeholder:o(l)("selectTips"),style:{width:"100%"},value:e.postIds,"onUpdate:value":a[8]||(a[8]=r=>e.postIds=r)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"])]),_:1}),t(p,{span:12},{default:s(()=>[t(d,{label:o(l)("user.columns.role")},{default:s(()=>[t(k,{mode:"multiple","max-tag-count":2,"show-search":"","filter-option":o(h),options:y.value,allowClear:"",placeholder:o(l)("selectTips"),style:{width:"100%"},value:e.roleIds,"onUpdate:value":a[9]||(a[9]=r=>e.roleIds=r)},null,8,["filter-option","options","placeholder","value"])]),_:1},8,["label"])]),_:1}),t(p,{span:24},{default:s(()=>[t(d,{label:o(l)("user.columns.remark")},{default:s(()=>[t(R,{allowClear:"",placeholder:o(l)("inputTips"),value:e.remark,"onUpdate:value":a[10]||(a[10]=r=>e.remark=r),valueModifiers:{trim:!0}},null,8,["placeholder","value"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["open","title","cancelText","okText"])}}});const re=j(ee,[["__scopeId","data-v-6bd9d054"]]);export{re as default};
